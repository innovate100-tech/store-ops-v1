# P4-E: settlement_actual.py UX ë³µêµ¬ ë³´ê³ ì„œ

## ë¬¸ì œ ë°œê²¬

ë¸”ë¡ ë¦¬ë“¬ ì ìš© ê³¼ì •ì—ì„œ **ìƒˆ í•­ëª© ì¶”ê°€/ì‚­ì œ ë²„íŠ¼ì´ ì œê±°**ë˜ì–´ ê¸°ëŠ¥ì´ ë™ì‘í•˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.

### ë°œê²¬ëœ ë¬¸ì œ

1. **ìƒˆ í•­ëª© ì¶”ê°€ ë²„íŠ¼ ì œê±°**: `render_new_item()` í•¨ìˆ˜ëŠ” ìˆì§€ë§Œ ì‹¤ì œ ì¶”ê°€ ë²„íŠ¼ì´ ì—†ìŒ
2. **í•­ëª© ì‚­ì œ ë²„íŠ¼ ì œê±°**: ê¸°ì¡´ í•­ëª©ì— ëŒ€í•œ ì‚­ì œ ë²„íŠ¼ì´ ì—†ìŒ
3. **ActionBarì— ëŒ€ì²´ ê¸°ëŠ¥ ì—†ìŒ**: ActionBarì˜ secondary_actionsì— ì¶”ê°€/ì‚­ì œ ê¸°ëŠ¥ì´ ì—†ìŒ

---

## ë³µêµ¬ì•ˆ ì ìš©

### 1. í•­ëª© ì‚­ì œ ë²„íŠ¼ ë³µêµ¬

**ìœ„ì¹˜**: ê° í•­ëª© ë¸”ë¡ ë‚´ë¶€ (ì˜¤ë¥¸ìª½ ë)
**ë°©ë²•**: `render_expense_item_with_delete()` í•¨ìˆ˜ë¡œ ì‚­ì œ ë²„íŠ¼ í¬í•¨

```python
def render_expense_item_with_delete():
    render_expense_item()
    if not readonly:
        col1, col2, col3, col4 = st.columns([2, 1.5, 2, 0.5])
        with col4:
            if st.button("ğŸ—‘ï¸", key=f"settlement_delete_{category}_{idx}_{year}_{month}", 
                         help="ì‚­ì œ", use_container_width=True):
                # ì‚­ì œ ë¡œì§ ì‹¤í–‰
                expense_items[category].pop(idx)
                st.rerun()
```

**UX ì„¤ëª…**:
- ê° í•­ëª© ë¸”ë¡ ì˜¤ë¥¸ìª½ ëì— ì‘ì€ ì‚­ì œ ë²„íŠ¼(ğŸ—‘ï¸) ë°°ì¹˜
- í´ë¦­ ì‹œ í…œí”Œë¦¿ì—ì„œ soft deleteí•˜ê³  session_stateì—ì„œë„ ì œê±°
- ì¦‰ì‹œ reruní•˜ì—¬ UI ì—…ë°ì´íŠ¸

---

### 2. ìƒˆ í•­ëª© ì¶”ê°€ ë²„íŠ¼ ë³µêµ¬

**ìœ„ì¹˜**: ìƒˆ í•­ëª© ì¶”ê°€ ë¸”ë¡ ë‚´ë¶€ (í•˜ë‹¨)
**ë°©ë²•**: `render_new_item_with_add()` í•¨ìˆ˜ë¡œ ì¶”ê°€ ë²„íŠ¼ í¬í•¨

```python
def render_new_item_with_add():
    render_new_item()
    if st.button("â• ì¶”ê°€", key=f"settlement_add_{category}_{year}_{month}", 
                use_container_width=True, type="primary"):
        # ìƒˆ í•­ëª© ì¶”ê°€ ë¡œì§ ì‹¤í–‰
        expense_items[category].append(new_item)
        st.rerun()
```

**UX ì„¤ëª…**:
- ìƒˆ í•­ëª© ì¶”ê°€ ë¸”ë¡ í•˜ë‹¨ì— Primary ìŠ¤íƒ€ì¼ ì¶”ê°€ ë²„íŠ¼ ë°°ì¹˜
- í•­ëª©ëª…, ì…ë ¥ë°©ì‹, ê¸ˆì•¡/ë¹„ìœ¨ ì…ë ¥ í›„ "â• ì¶”ê°€" ë²„íŠ¼ í´ë¦­
- í…œí”Œë¦¿ì— ì €ì¥í•˜ê³  session_stateì— ì¶”ê°€ í›„ ì¦‰ì‹œ rerun

---

## ë³µêµ¬ í›„ UX íë¦„

### ìƒˆ í•­ëª© ì¶”ê°€
1. ì¹´í…Œê³ ë¦¬ë³„ "ìƒˆ í•­ëª© ì¶”ê°€" ë¸”ë¡ì—ì„œ í•­ëª©ëª… ì…ë ¥
2. ì…ë ¥ë°©ì‹ ì„ íƒ (ê¸ˆì•¡/ë¹„ìœ¨)
3. ê¸ˆì•¡ ë˜ëŠ” ë¹„ìœ¨ ì…ë ¥
4. "â• ì¶”ê°€" ë²„íŠ¼ í´ë¦­
5. í…œí”Œë¦¿ ì €ì¥ + session_state ì¶”ê°€ + UI ì—…ë°ì´íŠ¸

### í•­ëª© ì‚­ì œ
1. ê° í•­ëª© ë¸”ë¡ ì˜¤ë¥¸ìª½ ëì˜ "ğŸ—‘ï¸" ë²„íŠ¼ í´ë¦­
2. í…œí”Œë¦¿ì—ì„œ soft delete
3. session_stateì—ì„œ ì œê±°
4. UI ì¦‰ì‹œ ì—…ë°ì´íŠ¸

---

## ê²€ì¦ í•„ìš” ì‚¬í•­

### ì½”ë“œ ë ˆë²¨ ê²€ì¦ âœ…
- ì‚­ì œ ë²„íŠ¼ í‚¤: `settlement_delete_{category}_{idx}_{year}_{month}` âœ…
- ì¶”ê°€ ë²„íŠ¼ í‚¤: `settlement_add_{category}_{year}_{month}` âœ…
- í´ë¡œì € ë³€ìˆ˜ ìº¡ì²˜: `current_idx`, `current_category` ì‚¬ìš© âœ…
- í•¨ìˆ˜ í˜¸ì¶œ: `_initialize_expense_items()`, `soft_delete_cost_item_template()`, `save_cost_item_template()` âœ…

### ì•± ì‹¤í–‰ ê²€ì¦ í•„ìš” (ì‚¬ìš©ì ìˆ˜í–‰)
1. ìƒˆ í•­ëª© ì¶”ê°€ ë²„íŠ¼ì´ "ìƒˆ í•­ëª© ì¶”ê°€" ë¸”ë¡ í•˜ë‹¨ì— í‘œì‹œë˜ëŠ”ì§€
2. í•­ëª© ì‚­ì œ ë²„íŠ¼ì´ ê° í•­ëª© ë¸”ë¡ ì˜¤ë¥¸ìª½ì— í‘œì‹œë˜ëŠ”ì§€
3. ì¶”ê°€/ì‚­ì œ í›„ UIê°€ ì¦‰ì‹œ ì—…ë°ì´íŠ¸ë˜ëŠ”ì§€
4. í…œí”Œë¦¿ ì €ì¥/ì‚­ì œê°€ ì •ìƒ ë™ì‘í•˜ëŠ”ì§€

---

## ë‹¤ìŒ ë‹¨ê³„

**STEP 0 ì™„ë£Œ í›„ STEP 1 ì§„í–‰**:
- target_cost_structure.pyì— ë™ì¼í•œ íŒ¨í„´ ì ìš©
- FormKit v2 + ë¸”ë¡ ë¦¬ë“¬ + ì¶”ê°€/ì‚­ì œ ë²„íŠ¼ í¬í•¨
