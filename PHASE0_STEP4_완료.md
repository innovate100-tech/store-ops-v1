# Phase 0 STEP 4 ì™„ë£Œ ë³´ê³ ì„œ
## "rerun êµ¬ì¡° ê°œì„  + ë°ì´í„° ë¡œë”© ë¹„ìš© ì ˆê°"

**ì‘ì—… ì¼ì**: 2026-01-24  
**ëª©í‘œ**: st.rerun í˜¸ì¶œ ìˆ«ìë¥¼ ì¤„ì´ëŠ” ê²Œ ì•„ë‹ˆë¼, "rerunì´ ë°œìƒí•´ë„ ëŠë¦¬ì§€ ì•Šê²Œ" ë§Œë“œëŠ” ê²ƒ

---

## 1ï¸âƒ£ ì €ì¥ í›„ rerun ì œê±°í•œ ìœ„ì¹˜ ëª©ë¡

### settlement_actual.py

| ë¼ì¸ | ì´ì „ íŒ¨í„´ | ë³€ê²½ í›„ | ê·¼ê±° |
|------|----------|---------|------|
| 272 | í…œí”Œë¦¿ ë‹¤ì‹œ ë¶ˆëŸ¬ì˜¤ê¸° í›„ `st.rerun()` | ì œê±° | session_state ë³€ê²½ë§Œìœ¼ë¡œ UI ìë™ ì—…ë°ì´íŠ¸ |
| 281 | ì—°/ì›” ë³€ê²½ ì‹œ `st.rerun()` | ì œê±° | Streamlit ìœ„ì ¯ ë³€ê²½(number_input) ìì²´ê°€ rerun ìœ ë°œ |
| 339 | ë§¤ì¶œ ë¶ˆëŸ¬ì˜¤ê¸° í›„ `st.rerun()` | ì œê±° | session_state ë³€ê²½ë§Œìœ¼ë¡œ UI ìë™ ì—…ë°ì´íŠ¸ |
| 351 | ìë™ê°’ìœ¼ë¡œ ë˜ëŒë¦¬ê¸° í›„ `st.rerun()` | ì œê±° | session_state ë³€ê²½ë§Œìœ¼ë¡œ UI ìë™ ì—…ë°ì´íŠ¸ |
| 506 | ì €ì¥ê°’ ë¶ˆëŸ¬ì˜¤ê¸° í›„ `st.rerun()` | ì œê±° | session_state ë³€ê²½ë§Œìœ¼ë¡œ UI ìë™ ì—…ë°ì´íŠ¸ |
| 548 | ì´ë²ˆë‹¬ ì €ì¥(draft) í›„ `st.rerun()` | ì œê±° | ì €ì¥ ì„±ê³µ ì‹œ toast í‘œì‹œ í›„ session_stateë§Œ ê°±ì‹  |
| 758 | í…œí”Œë¦¿ ì—…ë°ì´íŠ¸ í›„ `st.rerun()` | ì œê±° | session_state ë³€ê²½ë§Œìœ¼ë¡œ UI ìë™ ì—…ë°ì´íŠ¸ |
| 777 | í•­ëª© ì‚­ì œ í›„ `st.rerun()` | ì œê±° | session_state ë³€ê²½ë§Œìœ¼ë¡œ UI ìë™ ì—…ë°ì´íŠ¸ |
| 850 | í•­ëª© ì¶”ê°€ í›„ `st.rerun()` | ì œê±° | session_state ë³€ê²½ë§Œìœ¼ë¡œ UI ìë™ ì—…ë°ì´íŠ¸ |

**ìœ ì§€í•œ rerun**:
- 478: í™•ì • ì²˜ë¦¬ í›„ (readonly ìƒíƒœ ë³€ê²½ìœ¼ë¡œ í˜ì´ì§€ ì „ì²´ ì¬ë Œë”ë§ í•„ìš”)
- 496: í™•ì • í•´ì œ í›„ (readonly ìƒíƒœ ë³€ê²½ìœ¼ë¡œ í˜ì´ì§€ ì „ì²´ ì¬ë Œë”ë§ í•„ìš”)
- 1456: ì›” ì´ë™ (í˜ì´ì§€ ìƒíƒœ ë³€ê²½ìœ¼ë¡œ ì „ì²´ ì¬ë Œë”ë§ í•„ìš”)
- 1650: êµ¬ì¡° íŒê²° í™•ì¸ ì™„ë£Œ ì²˜ë¦¬ (ë£¨í‹´ ìƒíƒœ ë³€ê²½ìœ¼ë¡œ í˜ì´ì§€ ì „ì²´ ì¬ë Œë”ë§ í•„ìš”)

### sales_entry.py

| ë¼ì¸ | ì´ì „ íŒ¨í„´ | ë³€ê²½ í›„ | ê·¼ê±° |
|------|----------|---------|------|
| 280, 288 | DB ì—°ê²°/ë§¤ì¥ ì •ë³´ ì—ëŸ¬ í›„ `st.rerun()` | ì œê±° | ì—ëŸ¬ ë©”ì‹œì§€ëŠ” session_state ë³€ê²½ë§Œìœ¼ë¡œ í‘œì‹œ |
| 316, 320 | ì €ì¥ ì„±ê³µ/ì‹¤íŒ¨ í›„ `st.rerun()` | ì œê±° | session_state ë³€ê²½ë§Œìœ¼ë¡œ ë©”ì‹œì§€ í‘œì‹œ |
| 336 | ì˜ˆì™¸ ë°œìƒ í›„ `st.rerun()` | ì œê±° | ì—ëŸ¬ ë©”ì‹œì§€ëŠ” session_state ë³€ê²½ë§Œìœ¼ë¡œ í‘œì‹œ |
| 371, 378 | ì¼ê´„ ì €ì¥ ì—ëŸ¬ í›„ `st.rerun()` | ì œê±° | ì—ëŸ¬ ë©”ì‹œì§€ëŠ” session_state ë³€ê²½ë§Œìœ¼ë¡œ í‘œì‹œ |
| 454 | ì¼ê´„ ì €ì¥ ì™„ë£Œ í›„ `st.rerun()` | ì œê±° | session_state ë³€ê²½ë§Œìœ¼ë¡œ ë©”ì‹œì§€ í‘œì‹œ |
| 459 | ì¼ê´„ ì €ì¥ ì—ëŸ¬ í›„ `st.rerun()` | ì œê±° | ì—ëŸ¬ ë©”ì‹œì§€ëŠ” session_state ë³€ê²½ë§Œìœ¼ë¡œ í‘œì‹œ |
| 537 | ë„¤ì´ë²„ ë°©ë¬¸ì ì¼ê´„ ì €ì¥ í›„ `st.rerun()` | ì œê±° | session_state ë³€ê²½ë§Œìœ¼ë¡œ ë©”ì‹œì§€ í‘œì‹œ |

**ì´ ì œê±°**: 16ê°œ `st.rerun()` í˜¸ì¶œ

---

## 2ï¸âƒ£ ì—°/ì›” ë³€ê²½ ì¤‘ë³µ rerun ì œê±° ê²°ê³¼

### settlement_actual.py (ë¼ì¸ 275-281)

**ì´ì „ íŒ¨í„´**:
```python
if selected_year != year or selected_month != month:
    auto_sales_key = f"settlement_auto_sales_{selected_year}_{selected_month}"
    if auto_sales_key not in st.session_state:
        auto_sales = load_monthly_sales_total(store_id, selected_year, selected_month)
        st.session_state[auto_sales_key] = auto_sales
    st.rerun()  # â† ì¤‘ë³µ rerun
```

**ë³€ê²½ í›„**:
```python
if selected_year != year or selected_month != month:
    auto_sales_key = f"settlement_auto_sales_{selected_year}_{selected_month}"
    if auto_sales_key not in st.session_state:
        auto_sales = load_monthly_sales_total(store_id, selected_year, selected_month)
        st.session_state[auto_sales_key] = auto_sales
    # Phase 0 STEP 4: Streamlit ìœ„ì ¯ ë³€ê²½(number_input) ìì²´ê°€ rerunì„ ìœ ë°œí•˜ë¯€ë¡œ ì¤‘ë³µ rerun ì œê±°
    st.session_state["settlement_year"] = selected_year
    st.session_state["settlement_month"] = selected_month
```

**ê°œì„  íš¨ê³¼**:
- Streamlitì˜ `number_input` ìœ„ì ¯ ë³€ê²½ ìì²´ê°€ ìë™ rerunì„ ìœ ë°œí•˜ë¯€ë¡œ, ëª…ì‹œì  `st.rerun()` í˜¸ì¶œì€ ì¤‘ë³µ
- ì—°/ì›” ë³€ê²½ ì‹œ ë¶ˆí•„ìš”í•œ rerun ì œê±°ë¡œ ì²´ê° ì„±ëŠ¥ í–¥ìƒ

---

## 3ï¸âƒ£ ì„¹ì…˜ ë‹¨ìœ„ ë¡œë”©ìœ¼ë¡œ ë¶„í•´í•œ ê³³ 3ê°œ

### 1. settlement_actual.py - ë¶„ì„ ì„¹ì…˜ (ì„±ì í‘œ)

**ì´ì „**: í˜ì´ì§€ ë¡œë“œ ì‹œ í•­ìƒ ë¶„ì„ ì„¹ì…˜ ë°ì´í„° ë¡œë“œ
```python
# ë¶„ì„ ì˜ì—­ (Phase E: ì„±ì í‘œ)
_render_analysis_section(store_id, year, month, expense_items, totals, total_sales)
```

**ë³€ê²½ í›„**: expanderë¡œ lazy loading
```python
# ë¶„ì„ ì˜ì—­ (Phase E: ì„±ì í‘œ) - lazy loading (expander)
if 'settlement_analysis_expanded' not in st.session_state:
    st.session_state['settlement_analysis_expanded'] = False

with st.expander("ğŸ“Š ì´ë²ˆ ë‹¬ ì„±ì í‘œ (ëª©í‘œ ëŒ€ë¹„)", expanded=st.session_state['settlement_analysis_expanded']):
    if st.session_state['settlement_analysis_expanded']:
        _render_analysis_section(store_id, year, month, expense_items, totals, total_sales)
    else:
        st.info("ğŸ’¡ í¼ì¹˜ë©´ ì´ë²ˆ ë‹¬ ì„±ì í‘œë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.")
        if st.button("ğŸ“Š ì„±ì í‘œ ë³´ê¸°", key="settlement_expand_analysis", use_container_width=True):
            st.session_state['settlement_analysis_expanded'] = True
            st.rerun()
```

**íš¨ê³¼**: í˜ì´ì§€ ì´ˆê¸° ë¡œë“œ ì‹œ ì„±ì í‘œ ê³„ì‚° ë¹„ìš© ì ˆê° (ëª©í‘œ ë°ì´í„° ë¡œë“œ, ì •ê·œí™”, ì„±ì í‘œ ê³„ì‚° ë“±)

### 2. settlement_actual.py - íˆìŠ¤í† ë¦¬ ì„¹ì…˜

**ì´ì „**: í˜ì´ì§€ ë¡œë“œ ì‹œ í•­ìƒ íˆìŠ¤í† ë¦¬ ë°ì´í„° ë¡œë“œ
```python
# Phase H: ì›”ë³„ íˆìŠ¤í† ë¦¬ ì„¹ì…˜
_render_settlement_history(store_id)
```

**ë³€ê²½ í›„**: expanderë¡œ lazy loading
```python
# Phase H: ì›”ë³„ íˆìŠ¤í† ë¦¬ ì„¹ì…˜ - lazy loading (expander)
if 'settlement_history_expanded' not in st.session_state:
    st.session_state['settlement_history_expanded'] = False

with st.expander("ğŸ“Š ì›”ë³„ ì„±ì  íˆìŠ¤í† ë¦¬", expanded=st.session_state['settlement_history_expanded']):
    if st.session_state['settlement_history_expanded']:
        _render_settlement_history(store_id)
    else:
        st.info("ğŸ’¡ í¼ì¹˜ë©´ ìµœê·¼ ì›”ë³„ ì„±ì  íˆìŠ¤í† ë¦¬ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.")
        if st.button("ğŸ“… íˆìŠ¤í† ë¦¬ ë³´ê¸°", key="settlement_expand_history", use_container_width=True):
            st.session_state['settlement_history_expanded'] = True
            st.rerun()
```

**íš¨ê³¼**: í˜ì´ì§€ ì´ˆê¸° ë¡œë“œ ì‹œ íˆìŠ¤í† ë¦¬ ì¡°íšŒ ë¹„ìš© ì ˆê° (ì—¬ëŸ¬ ì›”ì˜ ìŠ¤ëƒ…ìƒ· ë¡œë“œ, ëª©í‘œ ë°ì´í„° ë¡œë“œ ë“±)

### 3. home_page.py - ZONE 4 (ì´ë²ˆ ì£¼ ìš°ì„ ìˆœìœ„ TOP3)

**ì´ì „**: í˜ì´ì§€ ë¡œë“œ ì‹œ í•­ìƒ ZONE 4 ë°ì´í„° ë¡œë“œ
```python
# ZONE 4: ì´ë²ˆ ì£¼ ìš°ì„ ìˆœìœ„ TOP3
_render_zone4_weekly_priorities(store_id, year, month)
```

**ë³€ê²½ í›„**: expanderë¡œ lazy loading
```python
# ZONE 4: ì´ë²ˆ ì£¼ ìš°ì„ ìˆœìœ„ TOP3 - lazy loading (expander)
if 'home_zone4_expanded' not in st.session_state:
    st.session_state['home_zone4_expanded'] = False

with st.expander("ğŸ“‹ ì´ë²ˆ ì£¼ ìš°ì„ ìˆœìœ„ TOP3", expanded=st.session_state['home_zone4_expanded']):
    if st.session_state['home_zone4_expanded']:
        _render_zone4_weekly_priorities(store_id, year, month)
    else:
        st.info("ğŸ’¡ í¼ì¹˜ë©´ ì´ë²ˆ ì£¼ ìš°ì„ ìˆœìœ„ TOP3ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.")
        if st.button("ğŸ“‹ ìš°ì„ ìˆœìœ„ ë³´ê¸°", key="home_expand_zone4", use_container_width=True):
            st.session_state['home_zone4_expanded'] = True
            st.rerun()
```

**íš¨ê³¼**: í™ˆ í˜ì´ì§€ ì´ˆê¸° ë¡œë“œ ì‹œ ì „ëµ ì¹´ë“œ/ë¡œë“œë§µ ê³„ì‚° ë¹„ìš© ì ˆê°

### 4. home_page.py - ZONE 5 (ê°€ê²Œ êµ¬ì¡° ìŠ¤ëƒ…ìƒ·)

**ì´ì „**: í˜ì´ì§€ ë¡œë“œ ì‹œ í•­ìƒ ZONE 5 ë°ì´í„° ë¡œë“œ
```python
# ZONE 5: ê°€ê²Œ êµ¬ì¡° ìŠ¤ëƒ…ìƒ· (ë³´ì¡°)
_render_zone5_design_snapshot(store_id, year, month)
```

**ë³€ê²½ í›„**: expanderë¡œ lazy loading
```python
# ZONE 5: ê°€ê²Œ êµ¬ì¡° ìŠ¤ëƒ…ìƒ· (ë³´ì¡°) - lazy loading (expander)
if 'home_zone5_expanded' not in st.session_state:
    st.session_state['home_zone5_expanded'] = False

with st.expander("ğŸŸ£ ê°€ê²Œ êµ¬ì¡° ìŠ¤ëƒ…ìƒ·", expanded=st.session_state['home_zone5_expanded']):
    if st.session_state['home_zone5_expanded']:
        _render_zone5_design_snapshot(store_id, year, month)
    else:
        st.info("ğŸ’¡ í¼ì¹˜ë©´ ê°€ê²Œ êµ¬ì¡° ìŠ¤ëƒ…ìƒ·ì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.")
        if st.button("ğŸŸ£ êµ¬ì¡° ìŠ¤ëƒ…ìƒ· ë³´ê¸°", key="home_expand_zone5", use_container_width=True):
            st.session_state['home_zone5_expanded'] = True
            st.rerun()
```

**íš¨ê³¼**: í™ˆ í˜ì´ì§€ ì´ˆê¸° ë¡œë“œ ì‹œ ì„¤ê³„ ìƒíƒœ ë¡œë“œ ë¹„ìš© ì ˆê°

---

## 4ï¸âƒ£ ì²´ê° ì„±ëŠ¥ ê°œì„  í¬ì¸íŠ¸ 3ê°œ

### 1. ì €ì¥ í›„ ì¦‰ì‹œ í”¼ë“œë°± (rerun ì—†ì´)

**ê°œì„  ì „**: ì €ì¥ ë²„íŠ¼ í´ë¦­ â†’ DB ì €ì¥ â†’ `st.rerun()` â†’ ì „ì²´ í˜ì´ì§€ ì¬ë Œë”ë§ (ëŠë¦¼)

**ê°œì„  í›„**: ì €ì¥ ë²„íŠ¼ í´ë¦­ â†’ DB ì €ì¥ â†’ `st.toast()` + `session_state` ê°±ì‹  â†’ UI ìë™ ì—…ë°ì´íŠ¸ (ë¹ ë¦„)

**ì²´ê° íš¨ê³¼**:
- ì €ì¥ í›„ ì¦‰ì‹œ í”¼ë“œë°± (toast ë©”ì‹œì§€)
- ì „ì²´ í˜ì´ì§€ ì¬ë Œë”ë§ ì—†ì´ í•„ìš”í•œ ë¶€ë¶„ë§Œ ì—…ë°ì´íŠ¸
- **ì˜ˆìƒ ê°œì„ **: ì €ì¥ í›„ ì‘ë‹µ ì‹œê°„ 50-70% ë‹¨ì¶•

### 2. ì—°/ì›” ë³€ê²½ ì‹œ ì¤‘ë³µ rerun ì œê±°

**ê°œì„  ì „**: ì—°/ì›” ë³€ê²½ â†’ ìœ„ì ¯ ìë™ rerun + ëª…ì‹œì  `st.rerun()` â†’ 2íšŒ rerun (ëŠë¦¼)

**ê°œì„  í›„**: ì—°/ì›” ë³€ê²½ â†’ ìœ„ì ¯ ìë™ rerunë§Œ â†’ 1íšŒ rerun (ë¹ ë¦„)

**ì²´ê° íš¨ê³¼**:
- ì—°/ì›” ë³€ê²½ ì‹œ ë¶ˆí•„ìš”í•œ ì¤‘ë³µ rerun ì œê±°
- **ì˜ˆìƒ ê°œì„ **: ì—°/ì›” ë³€ê²½ ì‘ë‹µ ì‹œê°„ 30-50% ë‹¨ì¶•

### 3. ì„¹ì…˜ ë‹¨ìœ„ lazy loading

**ê°œì„  ì „**: í˜ì´ì§€ ë¡œë“œ ì‹œ ëª¨ë“  ì„¹ì…˜ ë°ì´í„° ë¡œë“œ (ëŠë¦¼)
- ì‹¤ì œì •ì‚°: ì„±ì í‘œ ê³„ì‚° + íˆìŠ¤í† ë¦¬ ì¡°íšŒ
- í™ˆ: ì „ëµ ì¹´ë“œ + ë¡œë“œë§µ + êµ¬ì¡° ìŠ¤ëƒ…ìƒ·

**ê°œì„  í›„**: í˜ì´ì§€ ë¡œë“œ ì‹œ í•„ìˆ˜ ì„¹ì…˜ë§Œ ë¡œë“œ, ë‚˜ë¨¸ì§€ëŠ” expander í´ë¦­ ì‹œ ë¡œë“œ (ë¹ ë¦„)

**ì²´ê° íš¨ê³¼**:
- í˜ì´ì§€ ì´ˆê¸° ë¡œë“œ ì‹œê°„ ë‹¨ì¶•
- ì‚¬ìš©ìê°€ í•„ìš”í•œ ì„¹ì…˜ë§Œ ì„ íƒì ìœ¼ë¡œ ë¡œë“œ
- **ì˜ˆìƒ ê°œì„ **: ì‹¤ì œì •ì‚° í˜ì´ì§€ ì´ˆê¸° ë¡œë“œ ì‹œê°„ 40-60% ë‹¨ì¶•, í™ˆ í˜ì´ì§€ ì´ˆê¸° ë¡œë“œ ì‹œê°„ 20-30% ë‹¨ì¶•

---

## 5ï¸âƒ£ í…ŒìŠ¤íŠ¸ ì²´í¬ë¦¬ìŠ¤íŠ¸

### ì €ì¥ í›„ rerun ì œê±° í…ŒìŠ¤íŠ¸

- [ ] **settlement_actual.py - í…œí”Œë¦¿ ë‹¤ì‹œ ë¶ˆëŸ¬ì˜¤ê¸°**
  - í…œí”Œë¦¿ ë‹¤ì‹œ ë¶ˆëŸ¬ì˜¤ê¸° ë²„íŠ¼ í´ë¦­
  - âœ… í…œí”Œë¦¿ì´ ì¦‰ì‹œ ì—…ë°ì´íŠ¸ë˜ëŠ”ì§€ í™•ì¸ (rerun ì—†ì´)
  - âœ… ì„±ê³µ ë©”ì‹œì§€ê°€ í‘œì‹œë˜ëŠ”ì§€ í™•ì¸

- [ ] **settlement_actual.py - ì´ë²ˆë‹¬ ì €ì¥(draft)**
  - ë¹„ìš© í•­ëª© ì…ë ¥ í›„ ì €ì¥ ë²„íŠ¼ í´ë¦­
  - âœ… ì €ì¥ ì„±ê³µ ë©”ì‹œì§€ê°€ ì¦‰ì‹œ í‘œì‹œë˜ëŠ”ì§€ í™•ì¸ (rerun ì—†ì´)
  - âœ… toast ë©”ì‹œì§€ê°€ í‘œì‹œë˜ëŠ”ì§€ í™•ì¸
  - âœ… ì…ë ¥ê°’ì´ ìœ ì§€ë˜ëŠ”ì§€ í™•ì¸

- [ ] **sales_entry.py - ë§¤ì¶œ ì €ì¥**
  - ë§¤ì¶œ ì…ë ¥ í›„ ì €ì¥ ë²„íŠ¼ í´ë¦­
  - âœ… ì €ì¥ ì„±ê³µ ë©”ì‹œì§€ê°€ ì¦‰ì‹œ í‘œì‹œë˜ëŠ”ì§€ í™•ì¸ (rerun ì—†ì´)
  - âœ… toast ë©”ì‹œì§€ê°€ í‘œì‹œë˜ëŠ”ì§€ í™•ì¸

- [ ] **sales_entry.py - ì¼ê´„ ì €ì¥**
  - ì—¬ëŸ¬ ë‚ ì§œ ë§¤ì¶œ ì¼ê´„ ì €ì¥
  - âœ… ì €ì¥ ì™„ë£Œ ë©”ì‹œì§€ê°€ ì¦‰ì‹œ í‘œì‹œë˜ëŠ”ì§€ í™•ì¸ (rerun ì—†ì´)
  - âœ… balloons ì• ë‹ˆë©”ì´ì…˜ì´ í‘œì‹œë˜ëŠ”ì§€ í™•ì¸

### ì—°/ì›” ë³€ê²½ ì¤‘ë³µ rerun ì œê±° í…ŒìŠ¤íŠ¸

- [ ] **settlement_actual.py - ì—°/ì›” ë³€ê²½**
  - ì—°ë„ ë˜ëŠ” ì›” ë³€ê²½
  - âœ… ìœ„ì ¯ ë³€ê²½ë§Œìœ¼ë¡œ ìë™ rerunì´ ë°œìƒí•˜ëŠ”ì§€ í™•ì¸
  - âœ… ì¤‘ë³µ rerunì´ ì—†ëŠ”ì§€ í™•ì¸ (1íšŒë§Œ rerun)
  - âœ… ìë™ë§¤ì¶œì´ ì˜¬ë°”ë¥´ê²Œ ë¡œë“œë˜ëŠ”ì§€ í™•ì¸

### ì„¹ì…˜ ë‹¨ìœ„ lazy loading í…ŒìŠ¤íŠ¸

- [ ] **settlement_actual.py - ì„±ì í‘œ ì„¹ì…˜**
  - ì‹¤ì œì •ì‚° í˜ì´ì§€ ì§„ì…
  - âœ… ì„±ì í‘œ ì„¹ì…˜ì´ ì ‘í˜€ìˆëŠ”ì§€ í™•ì¸ (ì´ˆê¸° ë¡œë“œ ì‹œ ë°ì´í„° ë¡œë“œ ì•ˆ í•¨)
  - âœ… "ì„±ì í‘œ ë³´ê¸°" ë²„íŠ¼ í´ë¦­
  - âœ… ì„±ì í‘œê°€ ë¡œë“œë˜ëŠ”ì§€ í™•ì¸
  - âœ… ì„±ì í‘œ ë°ì´í„°ê°€ ì˜¬ë°”ë¥´ê²Œ í‘œì‹œë˜ëŠ”ì§€ í™•ì¸

- [ ] **settlement_actual.py - íˆìŠ¤í† ë¦¬ ì„¹ì…˜**
  - ì‹¤ì œì •ì‚° í˜ì´ì§€ ì§„ì…
  - âœ… íˆìŠ¤í† ë¦¬ ì„¹ì…˜ì´ ì ‘í˜€ìˆëŠ”ì§€ í™•ì¸ (ì´ˆê¸° ë¡œë“œ ì‹œ ë°ì´í„° ë¡œë“œ ì•ˆ í•¨)
  - âœ… "íˆìŠ¤í† ë¦¬ ë³´ê¸°" ë²„íŠ¼ í´ë¦­
  - âœ… íˆìŠ¤í† ë¦¬ê°€ ë¡œë“œë˜ëŠ”ì§€ í™•ì¸
  - âœ… íˆìŠ¤í† ë¦¬ ë°ì´í„°ê°€ ì˜¬ë°”ë¥´ê²Œ í‘œì‹œë˜ëŠ”ì§€ í™•ì¸

- [ ] **home_page.py - ZONE 4 (ìš°ì„ ìˆœìœ„ TOP3)**
  - í™ˆ í˜ì´ì§€ ì§„ì…
  - âœ… ZONE 4ê°€ ì ‘í˜€ìˆëŠ”ì§€ í™•ì¸ (ì´ˆê¸° ë¡œë“œ ì‹œ ë°ì´í„° ë¡œë“œ ì•ˆ í•¨)
  - âœ… "ìš°ì„ ìˆœìœ„ ë³´ê¸°" ë²„íŠ¼ í´ë¦­
  - âœ… ìš°ì„ ìˆœìœ„ê°€ ë¡œë“œë˜ëŠ”ì§€ í™•ì¸
  - âœ… ìš°ì„ ìˆœìœ„ ë°ì´í„°ê°€ ì˜¬ë°”ë¥´ê²Œ í‘œì‹œë˜ëŠ”ì§€ í™•ì¸

- [ ] **home_page.py - ZONE 5 (êµ¬ì¡° ìŠ¤ëƒ…ìƒ·)**
  - í™ˆ í˜ì´ì§€ ì§„ì…
  - âœ… ZONE 5ê°€ ì ‘í˜€ìˆëŠ”ì§€ í™•ì¸ (ì´ˆê¸° ë¡œë“œ ì‹œ ë°ì´í„° ë¡œë“œ ì•ˆ í•¨)
  - âœ… "êµ¬ì¡° ìŠ¤ëƒ…ìƒ· ë³´ê¸°" ë²„íŠ¼ í´ë¦­
  - âœ… êµ¬ì¡° ìŠ¤ëƒ…ìƒ·ì´ ë¡œë“œë˜ëŠ”ì§€ í™•ì¸
  - âœ… êµ¬ì¡° ìŠ¤ëƒ…ìƒ· ë°ì´í„°ê°€ ì˜¬ë°”ë¥´ê²Œ í‘œì‹œë˜ëŠ”ì§€ í™•ì¸

### ì„±ëŠ¥ ì¸¡ì • (ì„ íƒì‚¬í•­)

- [ ] **ì‹¤ì œì •ì‚° í˜ì´ì§€ ì´ˆê¸° ë¡œë“œ ì‹œê°„ ì¸¡ì •**
  - ê°œì„  ì „: ___ì´ˆ
  - ê°œì„  í›„: ___ì´ˆ
  - ê°œì„ ìœ¨: ___%

- [ ] **í™ˆ í˜ì´ì§€ ì´ˆê¸° ë¡œë“œ ì‹œê°„ ì¸¡ì •**
  - ê°œì„  ì „: ___ì´ˆ
  - ê°œì„  í›„: ___ì´ˆ
  - ê°œì„ ìœ¨: ___%

- [ ] **ì €ì¥ í›„ ì‘ë‹µ ì‹œê°„ ì¸¡ì •**
  - ê°œì„  ì „: ___ì´ˆ
  - ê°œì„  í›„: ___ì´ˆ
  - ê°œì„ ìœ¨: ___%

---

## 6ï¸âƒ£ ìˆ˜ì •ëœ íŒŒì¼ ë¦¬ìŠ¤íŠ¸

1. **ui_pages/settlement_actual.py**
   - ì €ì¥ í›„ rerun ì œê±°: 9ê°œ
   - ì—°/ì›” ë³€ê²½ ì¤‘ë³µ rerun ì œê±°: 1ê°œ
   - ì„¹ì…˜ ë‹¨ìœ„ lazy loading: 2ê°œ ì„¹ì…˜ (ì„±ì í‘œ, íˆìŠ¤í† ë¦¬)

2. **ui_pages/sales_entry.py**
   - ì €ì¥ í›„ rerun ì œê±°: 7ê°œ

3. **ui_pages/home/home_page.py**
   - ì„¹ì…˜ ë‹¨ìœ„ lazy loading: 2ê°œ ì„¹ì…˜ (ZONE 4, ZONE 5)

---

## 7ï¸âƒ£ ì•„ì§ ë‚¨ì€ ìœ„í—˜ ìš”ì†Œ

### 1. expander lazy loadingì˜ rerun í•„ìš”ì„±

**í˜„ì¬ êµ¬í˜„**: expander ì—´ê¸° ë²„íŠ¼ í´ë¦­ ì‹œ `st.rerun()` í˜¸ì¶œ

**ìœ„í—˜**: expanderê°€ ì—´ë¦´ ë•Œë§ˆë‹¤ ì „ì²´ í˜ì´ì§€ rerun ë°œìƒ

**ê°œì„  ë°©ì•ˆ** (í–¥í›„):
- Streamlitì˜ `st.expander`ëŠ” `expanded` íŒŒë¼ë¯¸í„° ë³€ê²½ë§Œìœ¼ë¡œë„ ìë™ ì—…ë°ì´íŠ¸ ê°€ëŠ¥
- ë²„íŠ¼ í´ë¦­ ëŒ€ì‹  `st.session_state` ë³€ê²½ë§Œìœ¼ë¡œ ì²˜ë¦¬ ê°€ëŠ¥ (ì¶”ê°€ ê²€ì¦ í•„ìš”)

### 2. ìºì‹œ ë¬´íš¨í™” ì „ëµ

**í˜„ì¬ ìƒíƒœ**: `soft_invalidate` í•¨ìˆ˜ê°€ ì´ë¯¸ í‚¤ ê¸°ë°˜ ë¬´íš¨í™”ë¥¼ ì§€ì›

**ê°œì„  ì—¬ì§€**:
- ì €ì¥ í›„ ë¶ˆí•„ìš”í•œ ì „ì²´ ìºì‹œ í´ë¦¬ì–´ ë°©ì§€
- í•„ìš”í•œ ìºì‹œë§Œ ì„ íƒì ìœ¼ë¡œ ë¬´íš¨í™” (ì´ë¯¸ êµ¬í˜„ë¨)

---

## 8ï¸âƒ£ ê²°ë¡ 

### ì™„ë£Œëœ ì‘ì—…

1. âœ… **ì €ì¥ í›„ rerun ì œê±°**: 16ê°œ `st.rerun()` í˜¸ì¶œ ì œê±°
2. âœ… **ì—°/ì›” ë³€ê²½ ì¤‘ë³µ rerun ì œê±°**: 1ê°œ ì¤‘ë³µ rerun ì œê±°
3. âœ… **ì„¹ì…˜ ë‹¨ìœ„ lazy loading**: 4ê°œ ì„¹ì…˜ì— ì ìš©

### ì˜ˆìƒ ì„±ëŠ¥ ê°œì„ 

- **ì €ì¥ í›„ ì‘ë‹µ ì‹œê°„**: 50-70% ë‹¨ì¶•
- **ì—°/ì›” ë³€ê²½ ì‘ë‹µ ì‹œê°„**: 30-50% ë‹¨ì¶•
- **ì‹¤ì œì •ì‚° í˜ì´ì§€ ì´ˆê¸° ë¡œë“œ**: 40-60% ë‹¨ì¶•
- **í™ˆ í˜ì´ì§€ ì´ˆê¸° ë¡œë“œ**: 20-30% ë‹¨ì¶•

### ë‹¤ìŒ ë‹¨ê³„ (Phase 0 STEP 5 ì˜ˆìƒ)

1. **expander lazy loading ìµœì í™”**: ë²„íŠ¼ í´ë¦­ ëŒ€ì‹  `session_state` ë³€ê²½ë§Œìœ¼ë¡œ ì²˜ë¦¬
2. **ìºì‹œ ë¬´íš¨í™” ì„¸ë°€í™”**: ì €ì¥ í›„ í•„ìš”í•œ ìºì‹œë§Œ ì„ íƒì ìœ¼ë¡œ ë¬´íš¨í™”
3. **ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§**: ì‹¤ì œ ì‚¬ìš©ì í™˜ê²½ì—ì„œ ì„±ëŠ¥ ì¸¡ì • ë° ê°œì„ 

---

**ì‘ì—… ì™„ë£Œì¼**: 2026-01-24  
**ë‹´ë‹¹**: Phase 0 STEP 4 ì•ˆì •í™” ì—”ì§€ë‹ˆì–´
