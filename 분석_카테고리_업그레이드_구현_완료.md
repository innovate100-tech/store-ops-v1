# 분석 카테고리 업그레이드 구현 완료 보고서

**작성 일자**: 2026-01-24  
**목적**: 분석 허브 도입 및 세부분석 구조 정리 완료

---

## ✅ 완료된 작업

### 1. 분석 허브 페이지 (`ui_pages/analysis/analysis_hub.py`)

#### ZONE A: 핵심 자료 6개 카드
- **매출**: 이번 달 누적 매출, 목표 대비 %
- **비용·손익**: 손익분기 매출, 이번 달 매출 대비 %
- **실제정산**: 순이익 (실제 매출 − 비용)
- **원가**: 고원가율 메뉴 수, 평균 원가율
- **재고**: 품절 위험 개수
- **재료 사용**: TOP 사용 재료 3개

**UI 개선**:
- 그라데이션 배경 카드 (다크 모드 스타일)
- 아이콘 + 제목 + 핵심 숫자 + 부가 정보
- "자세히 보기" 버튼으로 각 세부분석 페이지 이동

#### ZONE B: 세부분석선택 (expander)
- 기본 접힘 상태
- 10개 세부분석 페이지 링크:
  - 매출 분석, 비용 분석, 실제정산 분석, 원가 분석, 재고 분석, 재료 사용량
  - 판매·메뉴 분석, 매출 하락 원인 찾기, 검진 결과 요약, 검진 히스토리

---

### 2. 비용 분석 페이지 (`ui_pages/analysis/cost_analysis.py`)

#### ZONE A: 핵심 지표 카드
- 고정비, 변동비율, 손익분기 매출, 이번 달 매출

#### ZONE B: 목표매출 달성 시 비용구조
- 목표 매출 기반 비용 구조 시뮬레이션
- 고정비 + 변동비 = 총 비용
- 예상 순이익 계산
- 비용 구조 파이 차트 (고정비/변동비 비율)

#### ZONE C: 비용 구조 입력 현황
- 5개 카테고리별 입력 현황 (임차료, 인건비, 재료비, 공과금, 부가세&카드수수료)

#### ZONE D: 매출 수준별 시뮬레이션
- 사용자가 매출을 입력하면 해당 매출 수준에서 비용·영업이익 계산
- 손익분기 대비 비율 표시

---

### 3. 실제정산 분석 페이지 (`ui_pages/analysis/settlement_analysis.py`)

#### ZONE A: 목표 vs 실제 요약
- 목표 매출, 실제 매출, 실제 비용, 순이익
- 목표 대비 매출 달성률

#### ZONE B: 월간 성적표 상세
- 입력된 비용 항목 개수
- 카테고리별 비용 분석 (차트 + 테이블)
- 수익성 분석 (비용률, 이익률, 매출 대비 비용)

#### ZONE C: 월별 트렌드 (최근 3개월)
- 최근 3개월 매출/비용/순이익 라인 차트
- 월별 추이 한눈에 파악

---

### 4. app.py 변경

#### 메뉴 구조
- **📊 분석** 카테고리:
  - 항상 노출: `("분석 허브", "분석 허브")`
  - 세부분석선택 (expander): 10개 항목

#### 라우팅 추가
- `page == "분석 허브"` → `render_analysis_hub()`
- `page == "비용 분석"` → `render_cost_analysis()`
- `page == "실제정산 분석"` → `render_settlement_analysis()`

#### 분석 카테고리 특별 처리
- 입력 카테고리와 동일 패턴: 허브 버튼 + expander
- `category_name == "📊 분석"` 일 때:
  - 분석 허브 버튼 노출
  - `"📊 분석 (세부분석)"` → **세부분석선택** expander

---

## 📊 구현 결과

### 분석 허브 특징
- **본질**: 분석 자료 보기 → **핵심 지표 6개 카드**가 메인
- **부가**: 세부분석 페이지 링크는 expander로
- **입력 허브와 차이**: 입력 허브는 링크가 메인, 분석 허브는 자료가 메인

### 세부분석 구성
- **핵심 6개**: 매출, 비용, 실제정산, 원가, 재고, 재료 사용량
- **부가 4개**: 판매·메뉴 분석, 매출 하락 원인 찾기, 검진 결과/히스토리

---

## 🔍 주요 개선 사항

### 1. 분석 허브 카드 UI
- 기존: 단순 텍스트
- 개선: 그라데이션 배경 카드, 아이콘, 시각적 계층 구조

### 2. 비용 분석 기능
- 목표매출 달성 시 비용구조 분석
- 매출 수준별 시뮬레이션
- 비용 구조 파이 차트

### 3. 실제정산 분석 기능
- 카테고리별 비용 분석 (차트)
- 월별 트렌드 (최근 3개월)
- 수익성 분석 (비용률, 이익률)

---

## ✅ 검증 체크리스트

### 분석 허브
- [ ] 분석 허브 페이지 접근 가능
- [ ] 6개 핵심 지표 카드 정상 표시
- [ ] 각 카드 "자세히 보기" 버튼으로 해당 페이지 이동
- [ ] 세부분석선택 expander 정상 동작

### 비용 분석
- [ ] 비용 분석 페이지 접근 가능
- [ ] 핵심 지표 카드 정상 표시
- [ ] 목표매출 달성 시 비용구조 분석 정상
- [ ] 매출 수준별 시뮬레이션 정상

### 실제정산 분석
- [ ] 실제정산 분석 페이지 접근 가능
- [ ] 목표 vs 실제 비교 정상
- [ ] 월간 성적표 상세 정상
- [ ] 월별 트렌드 차트 정상

### app.py
- [ ] 사이드바 분석 카테고리에 "분석 허브" 항상 노출
- [ ] 세부분석선택 expander 정상 동작
- [ ] 모든 라우팅 정상 동작

---

## 📝 파일 목록

| 파일 | 역할 | 상태 |
|------|------|------|
| `ui_pages/analysis/analysis_hub.py` | 분석 허브 (핵심 자료 + 세부분석 링크) | ✅ 완료 |
| `ui_pages/analysis/cost_analysis.py` | 비용 분석 (목표 비용구조 기반) | ✅ 완료 |
| `ui_pages/analysis/settlement_analysis.py` | 실제정산 분석 (목표 vs 실제) | ✅ 완료 |
| `app.py` | 분석 카테고리 구조 + 라우팅 | ✅ 완료 |

---

## 🎯 다음 단계 (선택)

1. **분석 허브 데이터 로딩 최적화**
   - 경량 KPI 전용 데이터 로더 (`analysis_hub_data.py`)
   - 캐싱 전략 개선

2. **비용 분석 고도화**
   - 월간 집계 상세화
   - 매출 수준별 시뮬레이션 차트 추가

3. **실제정산 분석 고도화**
   - 월별 트렌드 확장 (6개월, 12개월)
   - 카테고리별 비용 상세 분석

---

**작성일**: 2026-01-24  
**참고**: `분석_카테고리_업그레이드_기획안.md`
