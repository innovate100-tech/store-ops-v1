# ë§¤ì¶œ ë¶„ì„ í˜ì´ì§€ ê³ ë„í™” ê¸°íšì•ˆ

**ì‘ì„± ì¼ì**: 2026-01-24  
**ëª©ì **: ì¼ìë³„ ì†ìµ ë¶„ì„ ë° ì‹¤ìš©ì ì¸ ê²½ì˜ ì¸ì‚¬ì´íŠ¸ ì œê³µ

---

## ğŸ“‹ ê°œìš”

í˜„ì¬ ë§¤ì¶œ ë¶„ì„ í˜ì´ì§€ëŠ” ê¸°ë³¸ì ì¸ ë§¤ì¶œ ì§€í‘œë§Œ ì œê³µí•©ë‹ˆë‹¤.  
**ì†ìµë¶„ê¸°ì **, **ëª©í‘œë§¤ì¶œêµ¬ì¡°**, **ë¹„ìš©êµ¬ì¡°**ë¥¼ í™œìš©í•˜ì—¬ **ì¼ìë³„ ë¹„ìš©Â·ì˜ì—…ì´ìµ ë¶„ì„**ê³¼ **ì‚¬ì¥ë‹˜ê»˜ ì‹¤ì§ˆì ìœ¼ë¡œ ë„ì›€ì´ ë˜ëŠ” ì¸ì‚¬ì´íŠ¸**ë¥¼ ì œê³µí•˜ë„ë¡ ê³ ë„í™”í•©ë‹ˆë‹¤.

---

## 1. í•µì‹¬ ê°œì„  ì‚¬í•­

### 1.1 ì¼ìë³„ ì†ìµ ë¶„ì„í‘œ (ì‹ ê·œ)

**ëª©ì **: ë§¤ì¼ ë§¤ì¶œ, ë¹„ìš©, ì˜ì—…ì´ìµì„ í•œëˆˆì— íŒŒì•…í•˜ì—¬ ì¼ë³„ ìˆ˜ìµì„±ì„ ì¦‰ì‹œ í™•ì¸.

| ì»¬ëŸ¼ | ì„¤ëª… | ê³„ì‚°ì‹ |
|------|------|--------|
| ë‚ ì§œ | ì¼ì | `daily_sales['ë‚ ì§œ']` |
| ë§¤ì¶œ | ì¼ë³„ ë§¤ì¶œ | `daily_sales['ì´ë§¤ì¶œ']` |
| ê³ ì •ë¹„ (ì¼í• ) | ì¼ë³„ ê³ ì •ë¹„ | `ê³ ì •ë¹„ / ì›”ì¼ìˆ˜` |
| ë³€ë™ë¹„ | ì¼ë³„ ë³€ë™ë¹„ | `ë§¤ì¶œ Ã— ë³€ë™ë¹„ìœ¨` |
| ì´ë¹„ìš© | ì¼ë³„ ì´ë¹„ìš© | `ê³ ì •ë¹„(ì¼í• ) + ë³€ë™ë¹„` |
| ì˜ì—…ì´ìµ | ì¼ë³„ ì˜ì—…ì´ìµ | `ë§¤ì¶œ - ì´ë¹„ìš©` |
| ì´ìµë¥  | ì¼ë³„ ì´ìµë¥  | `(ì˜ì—…ì´ìµ / ë§¤ì¶œ) Ã— 100` |
| ì†ìµë¶„ê¸° ëŒ€ë¹„ | ì†ìµë¶„ê¸° ëŒ€ë¹„ % | `(ë§¤ì¶œ / ì†ìµë¶„ê¸°ì¼í‰ê· ) Ã— 100` |
| ëª©í‘œ ëŒ€ë¹„ | ëª©í‘œ ëŒ€ë¹„ % | `(ë§¤ì¶œ / ëª©í‘œì¼í‰ê· ) Ã— 100` |
| ë“±ê¸‰ | ìˆ˜ìµì„± ë“±ê¸‰ | ğŸŸ¢ ì–‘í˜¸ / ğŸŸ¡ ë³´í†µ / ğŸ”´ ìœ„í—˜ |

**UI í˜•íƒœ**:
- ì •ë ¬ ê°€ëŠ¥í•œ ë°ì´í„°í”„ë ˆì„ (ë‚ ì§œ, ë§¤ì¶œ, ë¹„ìš©, ì´ìµ ìˆœì„œ)
- ìƒ‰ìƒ ì½”ë”©: ì˜ì—…ì´ìµ ì–‘ìˆ˜ â†’ ì´ˆë¡, 0 ê·¼ì²˜ â†’ ë…¸ë‘, ìŒìˆ˜ â†’ ë¹¨ê°•
- ìš”ì•½ í–‰: í•©ê³„, í‰ê· , ìµœê³ /ìµœì € ì¼ì

### 1.2 ê³ ë„í™”ëœ ë¶„ì„ í•¨ìˆ˜ë“¤

#### A. ìš”ì¼ë³„ íŒ¨í„´ ë¶„ì„
- ìš”ì¼ë³„ í‰ê·  ë§¤ì¶œ, ë¹„ìš©, ì˜ì—…ì´ìµ
- ìš”ì¼ë³„ ì†ìµë¶„ê¸° ë‹¬ì„±ë¥ 
- ìš”ì¼ë³„ ëª©í‘œ ë‹¬ì„±ë¥ 
- ìš”ì¼ë³„ ì´ìµë¥  ë¹„êµ
- **ì¸ì‚¬ì´íŠ¸**: "ì›”ìš”ì¼ ë§¤ì¶œì´ ëª©í‘œ ëŒ€ë¹„ 20% ë‚®ìŠµë‹ˆë‹¤. ì›”ìš”ì¼ í”„ë¡œëª¨ì…˜ì„ ê³ ë ¤í•´ë³´ì„¸ìš”."

#### B. ëª©í‘œ ë‹¬ì„± ì‹œë®¬ë ˆì´ì…˜
- ë‹¤ì–‘í•œ ë§¤ì¶œ ìˆ˜ì¤€ì—ì„œ ë¹„ìš©Â·ì´ìµ ê³„ì‚°
- ëª©í‘œ ë‹¬ì„± ì‹œ ì˜ˆìƒ ì˜ì—…ì´ìµ
- í˜„ì¬ ì¶”ì„¸ ìœ ì§€ ì‹œ ì˜ˆìƒ ì˜ì—…ì´ìµ
- í•„ìš” ì¼í‰ê·  ë§¤ì¶œ ë‹¬ì„± ì‹œ ì˜ˆìƒ ì˜ì—…ì´ìµ
- **ì¸ì‚¬ì´íŠ¸**: "ëª©í‘œ ë‹¬ì„± ì‹œ ì˜ˆìƒ ì˜ì—…ì´ìµ: 500ë§Œì›, í˜„ì¬ ì¶”ì„¸ ìœ ì§€ ì‹œ: 300ë§Œì›"

#### C. ë§¤ì¶œ í•˜ë½ ì›ì¸ ìë™ ì§„ë‹¨
- ìš”ì¼ë³„ ë§¤ì¶œ í•˜ë½ íŒ¨í„´
- ì¼ìë³„ ë§¤ì¶œ ê¸‰ë½ ê°ì§€ (ì „ì¼ ëŒ€ë¹„ -20% ì´ìƒ)
- ì†ìµë¶„ê¸° ë¯¸ë‹¬ ì¼ìˆ˜
- ëª©í‘œ ë¯¸ë‹¬ ì¼ìˆ˜
- **ì¸ì‚¬ì´íŠ¸**: "ì´ë²ˆ ë‹¬ ì†ìµë¶„ê¸° ë¯¸ë‹¬ ì¼ìˆ˜: 8ì¼ (ì „ì²´ì˜ 26%). ì£¼ë§ ë§¤ì¶œì´ íŠ¹íˆ ë‚®ìŠµë‹ˆë‹¤."

#### D. ë¹„ìš© êµ¬ì¡°ë³„ ë¯¼ê°ë„ ë¶„ì„
- ê³ ì •ë¹„ Â±10% ë³€í™” ì‹œë‚˜ë¦¬ì˜¤
- ë³€ë™ë¹„ìœ¨ Â±5% ë³€í™” ì‹œë‚˜ë¦¬ì˜¤
- ë§¤ì¶œ Â±20% ë³€í™” ì‹œë‚˜ë¦¬ì˜¤
- **ì¸ì‚¬ì´íŠ¸**: "ë³€ë™ë¹„ìœ¨ì„ 5%p ë‚®ì¶”ë©´ ì›” ì˜ì—…ì´ìµì´ 50ë§Œì› ì¦ê°€í•©ë‹ˆë‹¤."

#### E. ëª©í‘œ ë‹¬ì„± ë‚œì´ë„ í‰ê°€
- í˜„ì¬ ì¶”ì„¸ ê¸°ë°˜ ëª©í‘œ ë‹¬ì„± ê°€ëŠ¥ì„± (%)
- í•„ìš” ì¼í‰ê·  vs í˜„ì¬ ì¼í‰ê·  ë¹„êµ
- ë‚¨ì€ ê¸°ê°„ ëª©í‘œ ë‹¬ì„± ë‚œì´ë„ (ì‰¬ì›€/ë³´í†µ/ì–´ë ¤ì›€)
- **ì¸ì‚¬ì´íŠ¸**: "ëª©í‘œ ë‹¬ì„± ë‚œì´ë„: ì–´ë ¤ì›€ (í˜„ì¬ ì¶”ì„¸ ìœ ì§€ ì‹œ 85% ë‹¬ì„± ì˜ˆìƒ)"

#### F. ê°œì„  ì•¡ì…˜ ì•„ì´í…œ ì œì•ˆ
- ìë™ ë¶„ì„ ê¸°ë°˜ ê°œì„  ì œì•ˆ
- ìš°ì„ ìˆœìœ„ë³„ ì•¡ì…˜ ì•„ì´í…œ
- ì˜ˆìƒ íš¨ê³¼ (ë§¤ì¶œ/ì´ìµ ì¦ê°€ ì˜ˆìƒì¹˜)
- **ì¸ì‚¬ì´íŠ¸**: "ì£¼ë§ ë§¤ì¶œ 10% ì¦ê°€ ì‹œ ì›” ì˜ì—…ì´ìµ 30ë§Œì› ì¦ê°€ ì˜ˆìƒ"

---

## 2. ìƒˆë¡œìš´ í˜ì´ì§€ êµ¬ì¡° (ê³ ë„í™”)

### 2.1 ZONE A: í•µì‹¬ ì§€í‘œ (ê¸°ì¡´ ìœ ì§€ + ê°•í™”)

**ì¶”ê°€ ì§€í‘œ**:
- ì†ìµë¶„ê¸° ë‹¬ì„± ì¼ìˆ˜ / ì „ì²´ ì¼ìˆ˜
- ëª©í‘œ ë‹¬ì„± ì¼ìˆ˜ / ì „ì²´ ì¼ìˆ˜
- í‰ê·  ì¼ë³„ ì˜ì—…ì´ìµ
- ì†ìµë¶„ê¸° ëŒ€ë¹„ í˜„ì¬ ë§¤ì¶œ %

### 2.2 ZONE B: ëª©í‘œ vs ì‹¤ì œ (ê¸°ì¡´ ìœ ì§€ + ê°•í™”)

**ì¶”ê°€ ë‚´ìš©**:
- ì¼ìë³„ ì†ìµë¶„ê¸° ëŒ€ë¹„ ì¶”ì´ ì°¨íŠ¸ (ì´ì¤‘ ì¶•: ë§¤ì¶œ + ì†ìµë¶„ê¸° ë¼ì¸)
- ì¼ìë³„ ëª©í‘œ ëŒ€ë¹„ ì¶”ì´ ì°¨íŠ¸ (ì´ì¤‘ ì¶•: ë§¤ì¶œ + ëª©í‘œ ë¼ì¸)

### 2.3 ZONE C: ì¼ìë³„ ì†ìµ ë¶„ì„í‘œ (ì‹ ê·œ)

**ë‚´ìš©**:
- ì¼ìë³„ ë§¤ì¶œÂ·ë¹„ìš©Â·ì˜ì—…ì´ìµ ìƒì„¸ í‘œ
- ì •ë ¬, í•„í„°ë§ ê¸°ëŠ¥
- ìš”ì•½ í†µê³„ (í•©ê³„, í‰ê· , ìµœê³ /ìµœì €)
- ìƒ‰ìƒ ì½”ë”© (ì´ìµ ì–‘ìˆ˜/ìŒìˆ˜)

### 2.4 ZONE D: ìš”ì¼ë³„ íŒ¨í„´ ë¶„ì„ (ì‹ ê·œ)

**ë‚´ìš©**:
- ìš”ì¼ë³„ í‰ê·  ë§¤ì¶œÂ·ë¹„ìš©Â·ì´ìµ ë°” ì°¨íŠ¸
- ìš”ì¼ë³„ ì†ìµë¶„ê¸° ë‹¬ì„±ë¥ 
- ìš”ì¼ë³„ ëª©í‘œ ë‹¬ì„±ë¥ 
- ìš”ì¼ë³„ ì´ìµë¥  ë¹„êµ
- ìš”ì¼ë³„ ì¸ì‚¬ì´íŠ¸

### 2.5 ZONE E: íŠ¸ë Œë“œ ë¶„ì„ (ê¸°ì¡´ ìœ ì§€)

- ì¼ë³„ ë§¤ì¶œ ì¶”ì´
- ì›”ê°„ íŠ¸ë Œë“œ (ìµœê·¼ 6ê°œì›”)

### 2.6 ZONE F: ëª©í‘œ ë‹¬ì„± ì‹œë®¬ë ˆì´ì…˜ (ì‹ ê·œ)

**ë‚´ìš©**:
- ë§¤ì¶œ ìˆ˜ì¤€ë³„ ë¹„ìš©Â·ì´ìµ ê³„ì‚°ê¸°
- ëª©í‘œ ë‹¬ì„± ì‹œ ì˜ˆìƒ ì˜ì—…ì´ìµ
- í˜„ì¬ ì¶”ì„¸ ìœ ì§€ ì‹œ ì˜ˆìƒ ì˜ì—…ì´ìµ
- í•„ìš” ì¼í‰ê·  ë‹¬ì„± ì‹œ ì˜ˆìƒ ì˜ì—…ì´ìµ

### 2.7 ZONE G: ë¹„ìš© êµ¬ì¡° ë¯¼ê°ë„ ë¶„ì„ (ì‹ ê·œ)

**ë‚´ìš©**:
- ê³ ì •ë¹„ ë³€í™” ì‹œë‚˜ë¦¬ì˜¤ (Â±10%, Â±20%)
- ë³€ë™ë¹„ìœ¨ ë³€í™” ì‹œë‚˜ë¦¬ì˜¤ (Â±5%, Â±10%)
- ë§¤ì¶œ ë³€í™” ì‹œë‚˜ë¦¬ì˜¤ (Â±20%, Â±30%)
- ì‹œë‚˜ë¦¬ì˜¤ë³„ ì˜ì—…ì´ìµ ë³€í™” í‘œ

### 2.8 ZONE H: ìë™ ì§„ë‹¨ ë° ì•¡ì…˜ ì•„ì´í…œ (ì‹ ê·œ)

**ë‚´ìš©**:
- ë§¤ì¶œ í•˜ë½ ì›ì¸ ìë™ ì§„ë‹¨
- ëª©í‘œ ë‹¬ì„± ë‚œì´ë„ í‰ê°€
- ê°œì„  ì•¡ì…˜ ì•„ì´í…œ ì œì•ˆ (ìš°ì„ ìˆœìœ„ë³„)
- ì˜ˆìƒ íš¨ê³¼

### 2.9 ZONE I: ìƒì„¸ ë¶„ì„ (ê¸°ì¡´ ìœ ì§€)

- ë°©ë¬¸ì ë¶„ì„
- ê²°ì œ ìˆ˜ë‹¨ ë¶„ì„

---

## 3. ì¼ìë³„ ì†ìµ ë¶„ì„í‘œ ìƒì„¸ ìŠ¤í™

### 3.1 ë°ì´í„° ê³„ì‚°

```python
def _calculate_daily_profit_loss(store_id, year, month, daily_sales_df, fixed_costs, variable_ratio, breakeven_daily, target_daily):
    """
    ì¼ìë³„ ì†ìµ ë¶„ì„ ê³„ì‚°
    
    Args:
        daily_sales_df: ì¼ë³„ ë§¤ì¶œ DataFrame (ë‚ ì§œ, ì´ë§¤ì¶œ)
        fixed_costs: ì›” ê³ ì •ë¹„
        variable_ratio: ë³€ë™ë¹„ìœ¨ (0.0 ~ 1.0)
        breakeven_daily: ì†ìµë¶„ê¸° ì¼í‰ê·  ë§¤ì¶œ
        target_daily: ëª©í‘œ ì¼í‰ê·  ë§¤ì¶œ
    
    Returns:
        DataFrame with columns: ë‚ ì§œ, ë§¤ì¶œ, ê³ ì •ë¹„(ì¼í• ), ë³€ë™ë¹„, ì´ë¹„ìš©, ì˜ì—…ì´ìµ, ì´ìµë¥ , ì†ìµë¶„ê¸°ëŒ€ë¹„, ëª©í‘œëŒ€ë¹„, ë“±ê¸‰
    """
    days_in_month = monthrange(year, month)[1]
    daily_fixed = fixed_costs / days_in_month
    
    result = []
    for _, row in daily_sales_df.iterrows():
        date = row['ë‚ ì§œ']
        sales = row['ì´ë§¤ì¶œ']
        variable = sales * variable_ratio
        total_cost = daily_fixed + variable
        profit = sales - total_cost
        profit_rate = (profit / sales * 100) if sales > 0 else 0
        breakeven_ratio = (sales / breakeven_daily * 100) if breakeven_daily > 0 else 0
        target_ratio = (sales / target_daily * 100) if target_daily > 0 else 0
        
        # ë“±ê¸‰: ì˜ì—…ì´ìµ > 0 and ì†ìµë¶„ê¸° ë‹¬ì„± â†’ ğŸŸ¢, ì˜ì—…ì´ìµ > 0 but ì†ìµë¶„ê¸° ë¯¸ë‹¬ â†’ ğŸŸ¡, ì˜ì—…ì´ìµ <= 0 â†’ ğŸ”´
        if profit > 0 and breakeven_ratio >= 100:
            grade = "ğŸŸ¢ ì–‘í˜¸"
        elif profit > 0:
            grade = "ğŸŸ¡ ë³´í†µ"
        else:
            grade = "ğŸ”´ ìœ„í—˜"
        
        result.append({
            'ë‚ ì§œ': date,
            'ë§¤ì¶œ': sales,
            'ê³ ì •ë¹„(ì¼í• )': daily_fixed,
            'ë³€ë™ë¹„': variable,
            'ì´ë¹„ìš©': total_cost,
            'ì˜ì—…ì´ìµ': profit,
            'ì´ìµë¥ ': profit_rate,
            'ì†ìµë¶„ê¸°ëŒ€ë¹„': breakeven_ratio,
            'ëª©í‘œëŒ€ë¹„': target_ratio,
            'ë“±ê¸‰': grade
        })
    
    return pd.DataFrame(result)
```

### 3.2 UI êµ¬í˜„

- `st.dataframe` with `use_container_width=True`
- ì •ë ¬ ê°€ëŠ¥ (ë‚ ì§œ, ë§¤ì¶œ, ì˜ì—…ì´ìµ ë“±)
- ìƒ‰ìƒ ì½”ë”©: `st.dataframe`ì˜ `column_config` ì‚¬ìš©
- ìš”ì•½ í–‰: í•©ê³„, í‰ê· , ìµœê³ /ìµœì € ì¼ì í‘œì‹œ

---

## 4. ê³ ë„í™”ëœ ë¶„ì„ í•¨ìˆ˜ ìƒì„¸

### 4.1 ìš”ì¼ë³„ íŒ¨í„´ ë¶„ì„

```python
def _analyze_weekday_patterns(daily_profit_df):
    """
    ìš”ì¼ë³„ íŒ¨í„´ ë¶„ì„
    
    Returns:
        DataFrame: ìš”ì¼ë³„ í‰ê·  ë§¤ì¶œ, ë¹„ìš©, ì´ìµ, ì†ìµë¶„ê¸° ë‹¬ì„±ë¥ , ëª©í‘œ ë‹¬ì„±ë¥ 
    """
    daily_profit_df['ìš”ì¼'] = daily_profit_df['ë‚ ì§œ'].dt.day_name()
    weekday_summary = daily_profit_df.groupby('ìš”ì¼').agg({
        'ë§¤ì¶œ': 'mean',
        'ì´ë¹„ìš©': 'mean',
        'ì˜ì—…ì´ìµ': 'mean',
        'ì´ìµë¥ ': 'mean',
        'ì†ìµë¶„ê¸°ëŒ€ë¹„': 'mean',
        'ëª©í‘œëŒ€ë¹„': 'mean'
    }).reset_index()
    
    # ìš”ì¼ ìˆœì„œ ì •ë ¬ (ì›”~ì¼)
    weekday_order = ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday']
    weekday_summary['ìš”ì¼ìˆœì„œ'] = weekday_summary['ìš”ì¼'].map({day: i for i, day in enumerate(weekday_order)})
    weekday_summary = weekday_summary.sort_values('ìš”ì¼ìˆœì„œ')
    
    return weekday_summary
```

**ì¸ì‚¬ì´íŠ¸ ìƒì„±**:
- ìš”ì¼ë³„ ëª©í‘œ ë‹¬ì„±ë¥ ì´ 80% ë¯¸ë§Œì¸ ìš”ì¼ â†’ "XXìš”ì¼ ë§¤ì¶œì´ ëª©í‘œ ëŒ€ë¹„ ë‚®ìŠµë‹ˆë‹¤. í”„ë¡œëª¨ì…˜ì„ ê³ ë ¤í•´ë³´ì„¸ìš”."
- ìš”ì¼ë³„ ì´ìµë¥ ì´ ìŒìˆ˜ì¸ ìš”ì¼ â†’ "XXìš”ì¼ì€ ì†ì‹¤ì´ ë°œìƒí•˜ê³  ìˆìŠµë‹ˆë‹¤. ë¹„ìš© ì ˆê° ë˜ëŠ” ë§¤ì¶œ ì¦ëŒ€ê°€ í•„ìš”í•©ë‹ˆë‹¤."

### 4.2 ëª©í‘œ ë‹¬ì„± ì‹œë®¬ë ˆì´ì…˜

```python
def _simulate_target_achievement(store_id, year, month, current_sales, target_sales, fixed_costs, variable_ratio):
    """
    ëª©í‘œ ë‹¬ì„± ì‹œë®¬ë ˆì´ì…˜
    
    Returns:
        dict: {
            'target_profit': ëª©í‘œ ë‹¬ì„± ì‹œ ì˜ì—…ì´ìµ,
            'current_trend_profit': í˜„ì¬ ì¶”ì„¸ ìœ ì§€ ì‹œ ì˜ì—…ì´ìµ,
            'required_daily_profit': í•„ìš” ì¼í‰ê·  ë‹¬ì„± ì‹œ ì˜ì—…ì´ìµ
        }
    """
    days_in_month = monthrange(year, month)[1]
    today = today_kst()
    is_current = today.year == year and today.month == month
    current_day = today.day if is_current else days_in_month
    remaining = max(0, days_in_month - current_day)
    
    daily_avg = current_sales / current_day if current_day > 0 else 0
    forecast_sales = current_sales + (daily_avg * remaining) if current_day > 0 else current_sales
    
    # ëª©í‘œ ë‹¬ì„± ì‹œ
    target_variable = target_sales * variable_ratio
    target_total_cost = fixed_costs + target_variable
    target_profit = target_sales - target_total_cost
    
    # í˜„ì¬ ì¶”ì„¸ ìœ ì§€ ì‹œ
    forecast_variable = forecast_sales * variable_ratio
    forecast_total_cost = fixed_costs + forecast_variable
    current_trend_profit = forecast_sales - forecast_total_cost
    
    # í•„ìš” ì¼í‰ê·  ë‹¬ì„± ì‹œ
    required_daily = (target_sales - current_sales) / remaining if remaining > 0 else 0
    required_total_sales = current_sales + (required_daily * remaining) if remaining > 0 else current_sales
    required_variable = required_total_sales * variable_ratio
    required_total_cost = fixed_costs + required_variable
    required_daily_profit = required_total_sales - required_total_cost
    
    return {
        'target_profit': target_profit,
        'current_trend_profit': current_trend_profit,
        'required_daily_profit': required_daily_profit
    }
```

### 4.3 ë§¤ì¶œ í•˜ë½ ì›ì¸ ìë™ ì§„ë‹¨

```python
def _diagnose_sales_drop(daily_profit_df, target_daily, breakeven_daily):
    """
    ë§¤ì¶œ í•˜ë½ ì›ì¸ ìë™ ì§„ë‹¨
    
    Returns:
        dict: {
            'breakeven_fail_days': ì†ìµë¶„ê¸° ë¯¸ë‹¬ ì¼ìˆ˜,
            'target_fail_days': ëª©í‘œ ë¯¸ë‹¬ ì¼ìˆ˜,
            'worst_weekday': ê°€ì¥ ë‚®ì€ ìš”ì¼,
            'drop_days': ê¸‰ë½ ì¼ìˆ˜ (ì „ì¼ ëŒ€ë¹„ -20% ì´ìƒ),
            'insights': ì¸ì‚¬ì´íŠ¸ ë¦¬ìŠ¤íŠ¸
        }
    """
    insights = []
    
    # ì†ìµë¶„ê¸° ë¯¸ë‹¬ ì¼ìˆ˜
    breakeven_fail = len(daily_profit_df[daily_profit_df['ì†ìµë¶„ê¸°ëŒ€ë¹„'] < 100])
    if breakeven_fail > 0:
        insights.append(f"ì†ìµë¶„ê¸° ë¯¸ë‹¬ ì¼ìˆ˜: {breakeven_fail}ì¼ ({breakeven_fail/len(daily_profit_df)*100:.0f}%)")
    
    # ëª©í‘œ ë¯¸ë‹¬ ì¼ìˆ˜
    target_fail = len(daily_profit_df[daily_profit_df['ëª©í‘œëŒ€ë¹„'] < 100])
    if target_fail > 0:
        insights.append(f"ëª©í‘œ ë¯¸ë‹¬ ì¼ìˆ˜: {target_fail}ì¼ ({target_fail/len(daily_profit_df)*100:.0f}%)")
    
    # ê°€ì¥ ë‚®ì€ ìš”ì¼
    weekday_avg = daily_profit_df.groupby('ìš”ì¼')['ë§¤ì¶œ'].mean()
    worst_weekday = weekday_avg.idxmin()
    worst_avg = weekday_avg.min()
    if worst_avg < target_daily * 0.8:
        insights.append(f"{worst_weekday} ë§¤ì¶œì´ ëª©í‘œ ëŒ€ë¹„ ë‚®ìŠµë‹ˆë‹¤. ({worst_avg:,.0f}ì› vs ëª©í‘œ {target_daily:,.0f}ì›)")
    
    # ê¸‰ë½ ì¼ìˆ˜
    daily_profit_df_sorted = daily_profit_df.sort_values('ë‚ ì§œ')
    daily_profit_df_sorted['ì „ì¼ëŒ€ë¹„'] = daily_profit_df_sorted['ë§¤ì¶œ'].pct_change() * 100
    drop_days = len(daily_profit_df_sorted[daily_profit_df_sorted['ì „ì¼ëŒ€ë¹„'] < -20])
    if drop_days > 0:
        insights.append(f"ê¸‰ë½ ì¼ìˆ˜: {drop_days}ì¼ (ì „ì¼ ëŒ€ë¹„ -20% ì´ìƒ)")
    
    return {
        'breakeven_fail_days': breakeven_fail,
        'target_fail_days': target_fail,
        'worst_weekday': worst_weekday,
        'drop_days': drop_days,
        'insights': insights
    }
```

### 4.4 ë¹„ìš© êµ¬ì¡° ë¯¼ê°ë„ ë¶„ì„

```python
def _sensitivity_analysis(store_id, year, month, base_sales, fixed_costs, variable_ratio):
    """
    ë¹„ìš© êµ¬ì¡° ë¯¼ê°ë„ ë¶„ì„
    
    Returns:
        DataFrame: ì‹œë‚˜ë¦¬ì˜¤ë³„ ì˜ì—…ì´ìµ ë³€í™”
    """
    scenarios = []
    
    # ê³ ì •ë¹„ ë³€í™” ì‹œë‚˜ë¦¬ì˜¤
    for change in [-20, -10, 0, 10, 20]:
        new_fixed = fixed_costs * (1 + change / 100)
        variable = base_sales * variable_ratio
        total_cost = new_fixed + variable
        profit = base_sales - total_cost
        scenarios.append({
            'ì‹œë‚˜ë¦¬ì˜¤': f'ê³ ì •ë¹„ {change:+.0f}%',
            'ë§¤ì¶œ': base_sales,
            'ê³ ì •ë¹„': new_fixed,
            'ë³€ë™ë¹„': variable,
            'ì´ë¹„ìš©': total_cost,
            'ì˜ì—…ì´ìµ': profit,
            'ì´ìµë¥ ': (profit / base_sales * 100) if base_sales > 0 else 0
        })
    
    # ë³€ë™ë¹„ìœ¨ ë³€í™” ì‹œë‚˜ë¦¬ì˜¤
    for change in [-10, -5, 0, 5, 10]:
        new_var_ratio = variable_ratio * (1 + change / 100)
        variable = base_sales * new_var_ratio
        total_cost = fixed_costs + variable
        profit = base_sales - total_cost
        scenarios.append({
            'ì‹œë‚˜ë¦¬ì˜¤': f'ë³€ë™ë¹„ìœ¨ {change:+.0f}%',
            'ë§¤ì¶œ': base_sales,
            'ê³ ì •ë¹„': fixed_costs,
            'ë³€ë™ë¹„': variable,
            'ì´ë¹„ìš©': total_cost,
            'ì˜ì—…ì´ìµ': profit,
            'ì´ìµë¥ ': (profit / base_sales * 100) if base_sales > 0 else 0
        })
    
    # ë§¤ì¶œ ë³€í™” ì‹œë‚˜ë¦¬ì˜¤
    for change in [-30, -20, -10, 0, 10, 20, 30]:
        new_sales = base_sales * (1 + change / 100)
        variable = new_sales * variable_ratio
        total_cost = fixed_costs + variable
        profit = new_sales - total_cost
        scenarios.append({
            'ì‹œë‚˜ë¦¬ì˜¤': f'ë§¤ì¶œ {change:+.0f}%',
            'ë§¤ì¶œ': new_sales,
            'ê³ ì •ë¹„': fixed_costs,
            'ë³€ë™ë¹„': variable,
            'ì´ë¹„ìš©': total_cost,
            'ì˜ì—…ì´ìµ': profit,
            'ì´ìµë¥ ': (profit / new_sales * 100) if new_sales > 0 else 0
        })
    
    return pd.DataFrame(scenarios)
```

### 4.5 ëª©í‘œ ë‹¬ì„± ë‚œì´ë„ í‰ê°€

```python
def _assess_target_difficulty(store_id, year, month, current_sales, target_sales, daily_avg, required_daily):
    """
    ëª©í‘œ ë‹¬ì„± ë‚œì´ë„ í‰ê°€
    
    Returns:
        dict: {
            'difficulty': 'ì‰¬ì›€' | 'ë³´í†µ' | 'ì–´ë ¤ì›€',
            'achievement_probability': ë‹¬ì„± ê°€ëŠ¥ì„± (%),
            'gap_ratio': í•„ìš” ì¼í‰ê·  / í˜„ì¬ ì¼í‰ê·  ë¹„ìœ¨,
            'insight': ì¸ì‚¬ì´íŠ¸
        }
    """
    days_in_month = monthrange(year, month)[1]
    today = today_kst()
    is_current = today.year == year and today.month == month
    current_day = today.day if is_current else days_in_month
    remaining = max(0, days_in_month - current_day)
    
    forecast = current_sales + (daily_avg * remaining) if current_day > 0 else current_sales
    achievement_prob = (forecast / target_sales * 100) if target_sales > 0 else 0
    
    gap_ratio = (required_daily / daily_avg) if daily_avg > 0 else 0
    
    if achievement_prob >= 100:
        difficulty = "ì‰¬ì›€"
        insight = "í˜„ì¬ ì¶”ì„¸ ìœ ì§€ ì‹œ ëª©í‘œ ë‹¬ì„± ê°€ëŠ¥í•©ë‹ˆë‹¤."
    elif achievement_prob >= 90:
        difficulty = "ë³´í†µ"
        insight = f"ëª©í‘œ ë‹¬ì„±ì„ ìœ„í•´ ì¼í‰ê·  {required_daily:,.0f}ì›ì´ í•„ìš”í•©ë‹ˆë‹¤. (í˜„ì¬ {daily_avg:,.0f}ì› ëŒ€ë¹„ {gap_ratio:.1f}ë°°)"
    elif achievement_prob >= 80:
        difficulty = "ì–´ë ¤ì›€"
        insight = f"ëª©í‘œ ë‹¬ì„±ì´ ì–´ë ¤ìš¸ ê²ƒìœ¼ë¡œ ì˜ˆìƒë©ë‹ˆë‹¤. (ì˜ˆìƒ ë‹¬ì„±ë¥ : {achievement_prob:.1f}%)"
    else:
        difficulty = "ë§¤ìš° ì–´ë ¤ì›€"
        insight = f"ëª©í‘œ ë‹¬ì„±ì´ ë§¤ìš° ì–´ë ¤ìš¸ ê²ƒìœ¼ë¡œ ì˜ˆìƒë©ë‹ˆë‹¤. (ì˜ˆìƒ ë‹¬ì„±ë¥ : {achievement_prob:.1f}%)"
    
    return {
        'difficulty': difficulty,
        'achievement_probability': achievement_prob,
        'gap_ratio': gap_ratio,
        'insight': insight
    }
```

### 4.6 ê°œì„  ì•¡ì…˜ ì•„ì´í…œ ì œì•ˆ

```python
def _generate_action_items(store_id, year, month, daily_profit_df, weekday_summary, target_sales, breakeven_daily):
    """
    ê°œì„  ì•¡ì…˜ ì•„ì´í…œ ì œì•ˆ
    
    Returns:
        list: ìš°ì„ ìˆœìœ„ë³„ ì•¡ì…˜ ì•„ì´í…œ ë¦¬ìŠ¤íŠ¸
    """
    actions = []
    
    # 1. ì†ìµë¶„ê¸° ë¯¸ë‹¬ ì¼ìˆ˜ ë§ì„ ë•Œ
    breakeven_fail = len(daily_profit_df[daily_profit_df['ì†ìµë¶„ê¸°ëŒ€ë¹„'] < 100])
    if breakeven_fail > len(daily_profit_df) * 0.3:
        actions.append({
            'priority': 'ë†’ìŒ',
            'title': 'ì†ìµë¶„ê¸° ë¯¸ë‹¬ ì¼ìˆ˜ ê°ì†Œ',
            'description': f'ì†ìµë¶„ê¸° ë¯¸ë‹¬ ì¼ìˆ˜ê°€ {breakeven_fail}ì¼ë¡œ ë§ìŠµë‹ˆë‹¤. ë§¤ì¶œ ì¦ëŒ€ ë˜ëŠ” ë¹„ìš© ì ˆê°ì´ í•„ìš”í•©ë‹ˆë‹¤.',
            'expected_impact': f'ì†ìµë¶„ê¸° ë‹¬ì„± ì‹œ ì›” ì˜ì—…ì´ìµ {breakeven_fail * (breakeven_daily * 0.1):,.0f}ì› ì¦ê°€ ì˜ˆìƒ'
        })
    
    # 2. íŠ¹ì • ìš”ì¼ ë§¤ì¶œ ë‚®ì„ ë•Œ
    worst_weekday = weekday_summary.loc[weekday_summary['ë§¤ì¶œ'].idxmin()]
    if worst_weekday['ëª©í‘œëŒ€ë¹„'] < 80:
        actions.append({
            'priority': 'ì¤‘ê°„',
            'title': f'{worst_weekday["ìš”ì¼"]} ë§¤ì¶œ ì¦ëŒ€',
            'description': f'{worst_weekday["ìš”ì¼"]} ë§¤ì¶œì´ ëª©í‘œ ëŒ€ë¹„ {worst_weekday["ëª©í‘œëŒ€ë¹„"]:.0f}%ë¡œ ë‚®ìŠµë‹ˆë‹¤.',
            'expected_impact': f'{worst_weekday["ìš”ì¼"]} ë§¤ì¶œ 10% ì¦ê°€ ì‹œ ì›” ì˜ì—…ì´ìµ {worst_weekday["ë§¤ì¶œ"] * 0.1 * 4:,.0f}ì› ì¦ê°€ ì˜ˆìƒ'
        })
    
    # 3. ë³€ë™ë¹„ìœ¨ ë†’ì„ ë•Œ
    # (ë³€ë™ë¹„ìœ¨ì€ ì›”ê°„ í‰ê· ìœ¼ë¡œ ê³„ì‚° í•„ìš”)
    # ...
    
    return actions
```

---

## 5. UI/UX ê°œì„ 

### 5.1 ì¼ìë³„ ì†ìµ ë¶„ì„í‘œ

- **ì •ë ¬**: ë‚ ì§œ, ë§¤ì¶œ, ì˜ì—…ì´ìµ ë“± í´ë¦­ ì •ë ¬
- **í•„í„°**: ë“±ê¸‰ë³„ í•„í„° (ğŸŸ¢/ğŸŸ¡/ğŸ”´)
- **ìƒ‰ìƒ ì½”ë”©**: 
  - ì˜ì—…ì´ìµ ì–‘ìˆ˜ â†’ ì´ˆë¡ ë°°ê²½
  - ì˜ì—…ì´ìµ 0 ê·¼ì²˜ â†’ ë…¸ë‘ ë°°ê²½
  - ì˜ì—…ì´ìµ ìŒìˆ˜ â†’ ë¹¨ê°• ë°°ê²½
- **ìš”ì•½ í–‰**: í•©ê³„, í‰ê· , ìµœê³ /ìµœì € ì¼ì

### 5.2 ì‹œë®¬ë ˆì´ì…˜ UI

- ë§¤ì¶œ ì…ë ¥ ìŠ¬ë¼ì´ë” ë˜ëŠ” ìˆ«ì ì…ë ¥
- ì‹¤ì‹œê°„ ê³„ì‚° ê²°ê³¼ í‘œì‹œ
- ì°¨íŠ¸ë¡œ ì‹œê°í™” (ë§¤ì¶œ ìˆ˜ì¤€ë³„ ì˜ì—…ì´ìµ)

### 5.3 ë¯¼ê°ë„ ë¶„ì„ UI

- ì‹œë‚˜ë¦¬ì˜¤ë³„ ë¹„êµ í…Œì´ë¸”
- ì°¨íŠ¸ë¡œ ì‹œê°í™” (ê³ ì •ë¹„/ë³€ë™ë¹„/ë§¤ì¶œ ë³€í™”ì— ë”°ë¥¸ ì´ìµ ë³€í™”)
- ì¸ì‚¬ì´íŠ¸ í•˜ì´ë¼ì´íŠ¸

### 5.4 ìë™ ì§„ë‹¨ UI

- ì¹´ë“œ í˜•íƒœë¡œ ì§„ë‹¨ ê²°ê³¼ í‘œì‹œ
- ìš°ì„ ìˆœìœ„ë³„ ì•¡ì…˜ ì•„ì´í…œ ë¦¬ìŠ¤íŠ¸
- ì˜ˆìƒ íš¨ê³¼ ê°•ì¡°

---

## 6. ë°ì´í„° ë¡œë”© ë° ê³„ì‚°

### 6.1 í•„ìˆ˜ ë°ì´í„°

| ë°ì´í„° | ì†ŒìŠ¤ | ìš©ë„ |
|--------|------|------|
| ì¼ë³„ ë§¤ì¶œ | `load_best_available_daily_sales()` | ì¼ìë³„ ì†ìµ ë¶„ì„ |
| ê³ ì •ë¹„ | `get_fixed_costs()` | ì¼ìë³„ ê³ ì •ë¹„ ê³„ì‚° |
| ë³€ë™ë¹„ìœ¨ | `get_variable_cost_ratio()` | ì¼ìë³„ ë³€ë™ë¹„ ê³„ì‚° |
| ì†ìµë¶„ê¸° ë§¤ì¶œ | `calculate_break_even_sales()` | ì†ìµë¶„ê¸° ëŒ€ë¹„ ê³„ì‚° |
| ëª©í‘œ ë§¤ì¶œ | `targets.csv` | ëª©í‘œ ëŒ€ë¹„ ê³„ì‚° |

### 6.2 ê³„ì‚° ë¡œì§

- **ì¼ìë³„ ê³ ì •ë¹„**: `ê³ ì •ë¹„ / ì›”ì¼ìˆ˜`
- **ì¼ìë³„ ë³€ë™ë¹„**: `ì¼ë³„ ë§¤ì¶œ Ã— ë³€ë™ë¹„ìœ¨`
- **ì¼ìë³„ ì´ë¹„ìš©**: `ì¼ìë³„ ê³ ì •ë¹„ + ì¼ìë³„ ë³€ë™ë¹„`
- **ì¼ìë³„ ì˜ì—…ì´ìµ**: `ì¼ë³„ ë§¤ì¶œ - ì¼ìë³„ ì´ë¹„ìš©`
- **ì†ìµë¶„ê¸° ì¼í‰ê· **: `ì†ìµë¶„ê¸° ë§¤ì¶œ / ì›”ì¼ìˆ˜`
- **ëª©í‘œ ì¼í‰ê· **: `ëª©í‘œ ë§¤ì¶œ / ì›”ì¼ìˆ˜`

---

## 7. êµ¬í˜„ ìˆœì„œ

| ë‹¨ê³„ | ì‘ì—… | ë¹„ê³  |
|------|------|------|
| 1 | **ì¼ìë³„ ì†ìµ ë¶„ì„í‘œ** | `_calculate_daily_profit_loss()` í•¨ìˆ˜ êµ¬í˜„ |
| 2 | **ZONE C: ì¼ìë³„ ì†ìµ ë¶„ì„í‘œ UI** | ë°ì´í„°í”„ë ˆì„ + ìƒ‰ìƒ ì½”ë”© + ìš”ì•½ |
| 3 | **ìš”ì¼ë³„ íŒ¨í„´ ë¶„ì„** | `_analyze_weekday_patterns()` + ì°¨íŠ¸ |
| 4 | **ëª©í‘œ ë‹¬ì„± ì‹œë®¬ë ˆì´ì…˜** | `_simulate_target_achievement()` + UI |
| 5 | **ë¹„ìš© êµ¬ì¡° ë¯¼ê°ë„ ë¶„ì„** | `_sensitivity_analysis()` + ì°¨íŠ¸ |
| 6 | **ìë™ ì§„ë‹¨ ë° ì•¡ì…˜ ì•„ì´í…œ** | `_diagnose_sales_drop()`, `_assess_target_difficulty()`, `_generate_action_items()` |
| 7 | **ZONE A ê°•í™”** | ì†ìµë¶„ê¸° ë‹¬ì„± ì¼ìˆ˜ ë“± ì¶”ê°€ ì§€í‘œ |
| 8 | **ZONE B ê°•í™”** | ì†ìµë¶„ê¸°/ëª©í‘œ ëŒ€ë¹„ ì´ì¤‘ ì¶• ì°¨íŠ¸ |

---

## 8. ê¸°ëŒ€ íš¨ê³¼

### 8.1 ì‹¤ìš©ì„±

- **ì¼ìë³„ ìˆ˜ìµì„± ì¦‰ì‹œ íŒŒì•…**: ë§¤ì¼ ì†ìµì„ í•œëˆˆì— í™•ì¸
- **ìš”ì¼ë³„ íŒ¨í„´ íŒŒì•…**: ì•½í•œ ìš”ì¼ ì‹ë³„ ë° ëŒ€ì‘
- **ì‹œë®¬ë ˆì´ì…˜**: ë‹¤ì–‘í•œ ì‹œë‚˜ë¦¬ì˜¤ë¡œ ì˜ì‚¬ê²°ì • ì§€ì›
- **ìë™ ì§„ë‹¨**: ë¬¸ì œì  ìë™ ë°œê²¬ ë° í•´ê²°ì±… ì œì‹œ

### 8.2 ê²½ì˜ ì¸ì‚¬ì´íŠ¸

- **ë¹„ìš© êµ¬ì¡° ìµœì í™”**: ë¯¼ê°ë„ ë¶„ì„ìœ¼ë¡œ ë¹„ìš© ì ˆê° í¬ì¸íŠ¸ ë°œê²¬
- **ëª©í‘œ ë‹¬ì„± ì „ëµ**: ëª©í‘œ ë‹¬ì„± ë‚œì´ë„ í‰ê°€ ë° ì•¡ì…˜ ì•„ì´í…œ
- **ë§¤ì¶œ ì¦ëŒ€ ì „ëµ**: ìš”ì¼ë³„/ì¼ìë³„ íŒ¨í„´ ê¸°ë°˜ í”„ë¡œëª¨ì…˜ ì œì•ˆ

---

## 9. ì •ë¦¬

### í•µì‹¬ ì›ì¹™

1. **ì¼ìë³„ ì†ìµ ë¶„ì„**: ë§¤ì¼ ë§¤ì¶œ, ë¹„ìš©, ì´ìµì„ ëª…í™•íˆ í‘œì‹œ
2. **ì‹¤ìš©ì  ì¸ì‚¬ì´íŠ¸**: ì‚¬ì¥ë‹˜ì´ ë°”ë¡œ í™œìš©í•  ìˆ˜ ìˆëŠ” ë¶„ì„ ê²°ê³¼
3. **ìë™ ì§„ë‹¨**: ë¬¸ì œì  ìë™ ë°œê²¬ ë° í•´ê²°ì±… ì œì‹œ
4. **ì‹œë®¬ë ˆì´ì…˜**: ë‹¤ì–‘í•œ ì‹œë‚˜ë¦¬ì˜¤ë¡œ ì˜ì‚¬ê²°ì • ì§€ì›

### ë‹¤ìŒ ë‹¨ê³„

1. ê¸°íšì•ˆ ê²€í†  ë° ìŠ¹ì¸
2. ì¼ìë³„ ì†ìµ ë¶„ì„í‘œë¶€í„° ìˆœì°¨ êµ¬í˜„
3. ê° ë¶„ì„ í•¨ìˆ˜ë³„ í…ŒìŠ¤íŠ¸
4. ì „ì²´ í†µí•© í…ŒìŠ¤íŠ¸
5. ì‚¬ìš©ì í”¼ë“œë°± ë°˜ì˜

---

**ì‘ì„±ì¼**: 2026-01-24  
**ì°¸ê³ **: 
- `ë§¤ì¶œ_ë¶„ì„_í˜ì´ì§€_ì—…ê·¸ë ˆì´ë“œ_ê¸°íšì•ˆ.md`
- `ui_pages/analysis/cost_analysis.py`
- `ui_pages/analysis/sales_analysis.py` (í˜„ì¬ êµ¬í˜„)
