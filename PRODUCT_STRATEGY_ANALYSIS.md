# 🏪 매장 운영 시스템 v1 - 프로덕트 전략 분석

**분석 일자**: 2026-01-19  
**분석자**: 시니어 풀스택 리뷰어 + 프로덕트 전략가

---

## 1️⃣ 앱 한줄 정의 / 타겟 / 핵심 유저 플로우

### 한줄 정의
**"외식업 점장을 위한 올인원 운영 관리 시스템 - 매출부터 원가, 발주까지 한 화면에서"**

### 타겟 유저
- **1차 타겟**: 소규모 외식업 점장 (1-3개 매장 운영)
  - 일일 매출/비용 수기 기록에 지친 점장
  - 원가 관리가 어려워 수익성이 불투명한 점장
  - 발주 타이밍을 놓쳐 품절/과다재고를 겪는 점장
- **2차 타겟**: 프랜차이즈 본부 (다중 매장 관리)
- **3차 타겟**: 외식업 컨설턴트/회계사

### 핵심 유저 플로우 (Aha Moment까지)
```
1. 로그인 (Supabase Auth)
   ↓
2. 점장 마감 (1분 안에 하루치 매출+방문자+메뉴별 판매량 입력)
   ↓
3. 자동 계산되는 것들:
   - 재료 사용량 (판매량 × 레시피)
   - 원가율 (재료비 / 판매가)
   - 발주 추천 (재고 부족 예측)
   ↓
4. 비용구조 입력 (월 1회: 임차료/인건비/재료비/공과금/부가세)
   ↓
5. 실제정산 (월말: 실제 매출 vs 실제 비용 → 이익률 확인)
   ↓
6. ABC 분석 (어떤 메뉴가 돈 되는지 한눈에)
```

**Aha Moment**: "아, 이 메뉴 원가율이 45%네? 이거 수정해야겠다" (원가 파악 페이지)

---

## 2️⃣ 현재 기능 지도 (사이트맵) + 부족한 핵심 기능

### 현재 기능 지도

```
📊 매출 카테고리
├── 📋 점장 마감 (1분 마감 입력)
├── 📊 매출 관리 (단일/일괄 입력, 차트)
├── 📦 판매 관리 (전 메뉴 일괄 입력, ABC 분석)
└── 🛒 발주 관리 (재고 관리, 발주 추천)

💰 비용 카테고리
├── 📈 재료 사용량 집계 (기간별, ABC 분석)
├── 🍽️ 메뉴 등록 (일괄 등록, 카테고리, 순서 변경)
├── 🥬 재료 등록 (단위 자동 변환)
├── 📝 레시피 등록 (일괄 등록, 조리방법, 검색/수정)
└── 💰 원가 파악 (메뉴별 원가율 분석)

💳 재무 카테고리
├── 💳 비용구조 (월별 고정비/변동비 입력, 손익분기점)
├── 📈 매출구조 (목표 매출 시뮬레이션)
└── 🧾 실제정산 (월별 실제 매출/비용/이익)

📄 기타
├── 📄 주간 리포트 (PDF 생성)
└── 📊 통합 대시보드 (매출-방문자 상관관계)
```

### ✅ 강점 (완성도 높은 기능)
1. **점장 마감**: 1분 안에 하루치 모든 데이터 입력 (매출+방문자+메뉴별 판매량)
2. **원가 자동 계산**: 레시피 기반 원가율 실시간 계산
3. **발주 추천**: 재고 부족 예측 알고리즘
4. **ABC 분석**: 매출 대비 비중 분석 (재료 사용량, 메뉴 판매)
5. **실제정산**: 월별 실제 매출 vs 비용 비교
6. **RLS 보안**: Supabase 기반 멀티테넌트 완벽 구현

### ❌ 부족한 핵심 기능 (즉시 추가 필요)

#### 🔴 Critical (2주 내)
1. **알림 시스템**
   - 재고 부족 알림 (안전재고 이하)
   - 원가율 위험 메뉴 알림 (35% 이상)
   - 발주 필요 재료 알림
   - **현재**: 알림이 있지만 푸시/이메일 없음

2. **데이터 내보내기/백업**
   - Excel 다운로드 (모든 테이블)
   - 월별 정산서 PDF 자동 생성
   - **현재**: 백업 기능은 있지만 Excel 형식 없음

3. **모바일 최적화**
   - 점장 마감 모바일 전용 화면
   - **현재**: 반응형은 있지만 모바일 UX 미흡

#### 🟡 Important (6주 내)
4. **다중 매장 관리**
   - 프랜차이즈 본부용 대시보드
   - 매장별 비교 분석
   - **현재**: 단일 매장만 지원

5. **재료 가격 변동 이력**
   - 재료 단가 변경 히스토리
   - 원가 영향 분석
   - **현재**: 이력 관리 없음

6. **목표 대비 실적 대시보드**
   - 목표 매출 vs 실제 매출 (월별/연도별)
   - 목표 원가율 vs 실제 원가율
   - **현재**: target_gap_analysis는 있지만 시각화 부족

7. **POS 연동 (API)**
   - 카드단말기/키오스크 연동
   - 자동 매출 입력
   - **현재**: 수동 입력만 가능

#### 🟢 Nice to Have (3개월 내)
8. **직원 관리**
   - 근무 스케줄
   - 인건비 자동 계산
   - **현재**: 인건비는 입력만 가능

9. **공급업체 관리**
   - 발주 업체 정보
   - 발주 이력 관리
   - **현재**: 발주 추천만 있고 업체 정보 없음

10. **예측 분석 (AI)**
    - 다음 달 매출 예측
    - 계절성 분석
    - **현재**: 과거 데이터 분석만 가능

---

## 3️⃣ 데이터 모델 (ERD 수준) 요약

### 핵심 엔티티 관계도

```
stores (매장)
  ├── user_profiles (사용자-매장 연결)
  │
  ├── sales (일별 매출)
  ├── naver_visitors (일별 방문자)
  ├── daily_close (일별 마감 통합)
  │
  ├── menu_master (메뉴)
  │   ├── recipes (레시피) → ingredients (재료)
  │   └── daily_sales_items (일별 판매 내역)
  │
  ├── ingredients (재료)
  │   └── inventory (재고)
  │
  ├── targets (목표 매출/비용)
  ├── expense_structure (월별 비용 구조)
  ├── actual_settlement (월별 실제 정산)
  └── abc_history (ABC 분석 히스토리)
```

### 데이터 흐름
1. **입력**: 점장 마감 → `daily_close`, `sales`, `daily_sales_items`
2. **계산**: `daily_sales_items` + `recipes` → 재료 사용량
3. **분석**: `sales` + `menu_master` + `recipes` + `ingredients` → 원가율, ABC 분석
4. **예측**: 재료 사용량 + `inventory` → 발주 추천

### 데이터 무결성
- ✅ Foreign Key 제약조건 완비
- ✅ RLS (Row Level Security) 완벽 구현
- ✅ UNIQUE 제약조건 (중복 방지)
- ⚠️ 트랜잭션 처리 부족 (부분 실패 시 롤백 없음)

---

## 4️⃣ 운영에서 당장 써먹는 시나리오 5개

### 시나리오 1: "오늘 하루 마감 1분 안에 끝내기"
**사용자**: 점장  
**시간**: 매일 밤 10시  
**플로우**:
1. "점장 마감" 페이지 열기
2. 날짜/매장 선택 (자동)
3. 카드매출/현금매출 입력
4. 방문자수 입력
5. 메뉴별 판매수량 한 번에 입력 (3열 그리드)
6. 특이사항 체크 (품절/컴플레인 등)
7. "마감 완료" 클릭 → 자동 저장
**가치**: 기존 10분 → 1분 (90% 시간 절약)

### 시나리오 2: "이 메뉴 원가율이 너무 높아서 손해보는 거 아니야?"
**사용자**: 점장  
**시간**: 월 1회 (메뉴 가격 조정 시)  
**플로우**:
1. "원가 파악" 페이지 열기
2. 원가율 35% 이상인 메뉴 자동 경고 표시
3. "레시피 등록"에서 해당 메뉴 레시피 확인
4. 비싼 재료 찾기 (ABC 분석)
5. 레시피 수정 또는 판매가 조정
**가치**: 수익성 개선 (원가율 5% 감소 시 월 100만원 추가 이익)

### 시나리오 3: "내일 발주 뭐 사야 하지?"
**사용자**: 점장  
**시간**: 주 2-3회  
**플로우**:
1. "발주 관리" 페이지 열기
2. 재고 현황 확인 (현재고 vs 안전재고)
3. 발주 추천 리스트 확인 (자동 계산)
4. 발주 리스트 CSV 다운로드
5. 공급업체에 전달
**가치**: 품절 방지 + 과다재고 방지 (재고 회전율 20% 개선)

### 시나리오 4: "이번 달 실제로 얼마나 벌었지?"
**사용자**: 점장  
**시간**: 월말  
**플로우**:
1. "실제정산" 페이지 열기
2. 해당 월 선택 (자동으로 일매출 합계 계산)
3. 5대 비용 항목별 실제 지출 입력
   - 임차료, 인건비(5개 세부), 재료비, 공과금(전기/가스/수도+추가), 부가세&카드수수료(비율)
4. 실제 이익/이익률 확인
5. 저장
**가치**: 월별 수익성 투명성 확보 (회계사에게 전달 가능)

### 시나리오 5: "어떤 메뉴가 제일 돈 되나?"
**사용자**: 점장  
**시간**: 주 1회 (메뉴 구성 조정 시)  
**플로우**:
1. "판매 관리" → "ABC 분석" 열기
2. 기간 선택 (최근 1개월)
3. 메뉴별 매출/원가/이익률 확인
4. A등급 메뉴(상위 70%) 집중 판매 전략 수립
5. C등급 메뉴(하위 10%) 퇴출 검토
**가치**: 메뉴 구성 최적화 (매출 10-15% 증가)

---

## 5️⃣ 사업화 (과금/패키징) 모델 3개 + 가격대 가설

### 모델 1: "기본 플랜" (개인 점장용)
**가격**: 월 29,000원  
**포함**:
- 매장 1개
- 사용자 1명
- 모든 기본 기능 (매출/비용/재료/레시피/원가/발주)
- 데이터 저장 1년
- 이메일 지원

**타겟**: 소규모 외식업 점장 (월 매출 3천만원 이하)

### 모델 2: "프로 플랜" (프랜차이즈/다중 매장)
**가격**: 월 99,000원  
**포함**:
- 매장 최대 10개
- 사용자 최대 5명
- 기본 기능 + 다중 매장 비교 분석
- Excel 다운로드
- 월별 정산서 PDF 자동 생성
- 우선 지원

**타겟**: 프랜차이즈 본부, 다중 매장 운영자 (월 매출 1억 이상)

### 모델 3: "엔터프라이즈 플랜" (대규모)
**가격**: 월 299,000원 (또는 연 300만원)  
**포함**:
- 매장 무제한
- 사용자 무제한
- 모든 기능 + POS 연동 API
- 맞춤형 대시보드
- 전담 CS 매니저
- 온보딩 지원

**타겟**: 대형 프랜차이즈 본부 (매장 50개 이상)

### 가격 전략 가설
- **경쟁사 대비**: 
  - Toast POS: 월 20-50만원 (하드웨어 포함)
  - 우리: 소프트웨어만 2.9만원 → **10배 저렴**
- **가치 기반 가격**: 
  - 점장 1명 시간 절약: 월 20시간 × 시급 2만원 = 40만원
  - 우리 가격: 2.9만원 → **ROI 1,379%**
- **프리미엄 전략**: 
  - 무료 체험 14일
  - 연간 결제 시 20% 할인

---

## 6️⃣ 2주/6주/3개월 로드맵 (각 단계 핵심 KPI 포함)

### 🚀 Phase 1: 즉시 수익화 (2주)

#### 목표: 첫 유료 고객 확보

**핵심 작업**:
1. **알림 시스템** (3일)
   - 재고 부족 알림 (이메일/앱 내)
   - 원가율 위험 메뉴 알림
   - KPI: 알림 발송률 95% 이상

2. **Excel 다운로드** (2일)
   - 모든 테이블 Excel 내보내기
   - 월별 정산서 Excel 템플릿
   - KPI: 다운로드 기능 사용률 60% 이상

3. **모바일 최적화** (3일)
   - 점장 마감 모바일 전용 화면
   - 터치 친화적 UI
   - KPI: 모바일 사용률 40% 이상

4. **결제 시스템 연동** (4일)
   - Stripe/Toss Payments 연동
   - 무료 체험 14일
   - KPI: 체험→유료 전환율 15% 이상

5. **온보딩 튜토리얼** (2일)
   - 첫 로그인 시 가이드
   - KPI: 완료율 80% 이상

**예상 결과**: 
- 유료 고객 10명 확보
- 월 수익: 29만원
- NPS: 50 이상

---

### 📈 Phase 2: 기능 확장 (6주)

#### 목표: 고객 유지율 90% + 신규 고객 50명

**핵심 작업**:
1. **다중 매장 관리** (2주)
   - 매장별 대시보드
   - 매장 간 비교 분석
   - KPI: 다중 매장 사용률 30% 이상

2. **재료 가격 변동 이력** (1주)
   - 단가 변경 히스토리
   - 원가 영향 분석
   - KPI: 이력 조회율 50% 이상

3. **목표 대비 실적 대시보드** (1주)
   - 목표 매출 vs 실제 매출 차트
   - 목표 원가율 vs 실제 원가율
   - KPI: 목표 설정률 70% 이상

4. **POS 연동 API** (2주)
   - 카드단말기 연동 (예: KICC, 나이스페이)
   - 자동 매출 입력
   - KPI: POS 연동 사용률 20% 이상

5. **고객 지원 시스템** (1주)
   - 인앱 채팅
   - FAQ 섹션
   - KPI: 고객 만족도 4.5/5.0 이상

**예상 결과**:
- 유료 고객 50명
- 월 수익: 145만원
- 고객 유지율: 90%
- NPS: 60 이상

---

### 🎯 Phase 3: 스케일링 (3개월)

#### 목표: 월 수익 500만원 + 프랜차이즈 고객 5개사

**핵심 작업**:
1. **직원 관리 모듈** (3주)
   - 근무 스케줄
   - 인건비 자동 계산
   - KPI: 직원 관리 사용률 40% 이상

2. **공급업체 관리** (2주)
   - 발주 업체 정보
   - 발주 이력 관리
   - KPI: 공급업체 등록률 80% 이상

3. **예측 분석 (AI)** (4주)
   - 다음 달 매출 예측 (시계열 분석)
   - 계절성 분석
   - KPI: 예측 정확도 85% 이상

4. **프랜차이즈 대시보드** (3주)
   - 본부용 통합 대시보드
   - 매장별 KPI 비교
   - KPI: 프랜차이즈 고객 5개사 확보

5. **마케팅 자동화** (2주)
   - 이메일 마케팅
   - 리텐션 캠페인
   - KPI: 마케팅 전환율 5% 이상

**예상 결과**:
- 유료 고객 200명 (개인 150명 + 프랜차이즈 5개사)
- 월 수익: 500만원
- 고객 유지율: 95%
- NPS: 70 이상

---

## 7️⃣ 코드/보안/성능에서 즉시 고칠 Top10 (심각도 순)

### 🔴 Critical (즉시 수정)

#### 1. **트랜잭션 처리 부족** (심각도: 🔴🔴🔴)
**문제**: `save_daily_close`에서 여러 테이블에 저장 시 부분 실패 시 롤백 없음  
**위치**: `src/storage_supabase.py:908`  
**영향**: 데이터 불일치 가능  
**해결**: Supabase 트랜잭션 래퍼 함수 추가
```python
# 예시
@transaction
def save_daily_close(...):
    # 모든 저장 작업을 하나의 트랜잭션으로
```

#### 2. **에러 핸들링 미흡** (심각도: 🔴🔴🔴)
**문제**: `load_csv`에서 예외 발생 시 빈 DataFrame 반환만 함  
**위치**: `src/storage_supabase.py:258`  
**영향**: 사용자가 데이터가 없다고 착각  
**해결**: 에러 로깅 + 사용자 친화적 메시지

#### 3. **세션 만료 처리 부족** (심각도: 🔴🔴)
**문제**: Supabase 토큰 만료 시 자동 재로그인 없음  
**위치**: `src/auth.py:47`  
**영향**: 사용자가 갑자기 로그아웃됨  
**해결**: 토큰 자동 갱신 로직 추가

#### 4. **SQL Injection 위험** (심각도: 🔴🔴)
**문제**: 일부 쿼리에서 사용자 입력 직접 사용 가능성  
**위치**: 전체 코드베이스  
**영향**: 보안 취약점  
**해결**: Supabase 클라이언트 사용 (이미 대부분 적용됨, 검증 필요)

### 🟡 Important (2주 내)

#### 5. **캐시 무효화 로직 불일치** (심각도: 🟡🟡)
**문제**: `load_csv.clear()` 호출이 일관되지 않음  
**위치**: 여러 페이지  
**영향**: 데이터 업데이트 지연  
**해결**: 표준화된 캐시 무효화 패턴 적용

#### 6. **대용량 데이터 성능** (심각도: 🟡🟡)
**문제**: 메뉴 100개+ 시 점장 마감 페이지 느림  
**위치**: `src/ui.py:910`  
**영향**: 사용자 경험 저하  
**해결**: 가상화(Virtualization) 또는 페이지네이션

#### 7. **동시성 문제** (심각도: 🟡)
**문제**: 여러 사용자가 동시에 같은 데이터 수정 시 충돌 가능  
**위치**: 전체 코드베이스  
**영향**: 데이터 덮어쓰기  
**해결**: Optimistic Locking 또는 Versioning

### 🟢 Nice to Have (1개월 내)

#### 8. **로깅 시스템 강화** (심각도: 🟢)
**문제**: 에러 로깅은 있지만 비즈니스 로직 로깅 부족  
**위치**: 전체 코드베이스  
**영향**: 디버깅 어려움  
**해결**: 구조화된 로깅 (JSON 형식)

#### 9. **테스트 코드 부재** (심각도: 🟢)
**문제**: 단위 테스트/통합 테스트 없음  
**위치**: 전체 코드베이스  
**영향**: 리팩토링 위험  
**해결**: pytest 기반 테스트 스위트 작성

#### 10. **문서화 부족** (심각도: 🟢)
**문제**: API 문서, 아키텍처 문서 없음  
**위치**: 전체 코드베이스  
**영향**: 유지보수 어려움  
**해결**: Sphinx 기반 문서화

---

## 📊 종합 평가

### 완성도: **75/100**
- ✅ 핵심 기능 완비
- ✅ 보안 (RLS) 완벽
- ⚠️ 에러 핸들링 개선 필요
- ⚠️ 성능 최적화 필요

### 핵심 가치/차별점
1. **1분 마감**: 기존 10분 → 1분 (90% 시간 절약)
2. **원가 자동 계산**: 레시피 기반 실시간 원가율
3. **발주 예측**: 재고 부족 사전 예방
4. **ABC 분석**: 데이터 기반 의사결정
5. **가격 경쟁력**: 경쟁사 대비 10배 저렴

### 리스크/병목
1. **기술적**: 트랜잭션 처리 부족 → 데이터 불일치 위험
2. **비즈니스**: 마케팅 채널 부재 → 고객 확보 어려움
3. **운영**: 고객 지원 시스템 부재 → 이탈률 증가 위험

### 즉시 수익화 가능성: **높음** ✅
- MVP 완성도 높음
- 명확한 타겟 유저
- 강력한 가치 제안 (시간 절약 + 수익성 개선)
- 낮은 진입 장벽 (무료 체험)

---

## 🎯 즉시 실행 가능한 액션 아이템 (우선순위)

### 이번 주 (Week 1)
1. ✅ 트랜잭션 처리 추가
2. ✅ 에러 핸들링 개선
3. ✅ Excel 다운로드 기능
4. ✅ 결제 시스템 연동 준비

### 다음 주 (Week 2)
5. ✅ 알림 시스템
6. ✅ 모바일 최적화
7. ✅ 온보딩 튜토리얼
8. ✅ 베타 테스터 모집

### 1개월 내
9. ✅ 마케팅 랜딩 페이지
10. ✅ 고객 지원 시스템

---

**결론**: 이 앱은 **즉시 수익화 가능한 MVP**입니다. 2주 내 핵심 개선사항만 해결하면 첫 유료 고객 확보 가능. 외식업 점장의 실제 Pain Point를 정확히 해결하는 강력한 제품입니다. 🚀
