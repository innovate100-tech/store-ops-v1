# 판매 메뉴 분석 페이지 — 데이터 소스 검증

**검증 일자**: 2026-01-24  
**목적**: 도출되는 모든 자료가 **앱 사용자 입력 기반**인지 확인, **입력하지 않는 자료** 사용 여부 점검

---

## 1. 데이터 소스 요약

| 구분 | 데이터 | 소스(테이블/함수) | 사용자 입력 여부 | 입력 화면 |
|------|--------|-------------------|------------------|-----------|
| 메뉴 | 메뉴명, 판매가 | `menu_master` (load_csv) | ✅ 입력 | 메뉴 입력 |
| 판매 | 날짜, 메뉴명, 판매수량 | `daily_sales_items` (load_csv) | ✅ 입력 | 일일 마감 / 판매량 등록 |
| 레시피 | 메뉴명, 재료명, 사용량 | `recipes` (load_csv) | ✅ 입력 | 레시피 입력 |
| 재료 | 재료명, 단위, 단가 | `ingredient_master` (load_csv) | ✅ 입력 | 재료 입력 |
| 역할/카테고리 | 메뉴별 역할(미끼/볼륨/마진), 카테고리(대표/주력/유인/보조) | `get_menu_portfolio_tags`, `get_menu_portfolio_categories` (DB/session_state) | ✅ 입력 | 메뉴 포트폴리오 설계실 등 |

---

## 2. ZONE별 사용 데이터 및 입력 기반 여부

### ZONE A (핵심 지표)
- **사용**: `filtered_sales_df`, `summary_df`, `monthly_trend_df`, `roles_dict`, `categories_dict`, `menu_df`
- **판매/메뉴/트렌드**: 전부 사용자 입력 기반 ✅  
- **포트폴리오 균형**: 역할·카테고리 사용자 입력 ✅ (미입력 시 미분류로 처리)

### ZONE B (기간별 집계, ABC, TOP10)
- **사용**: `summary_df`(판매+메뉴+원가), `monthly_trend_df`
- **원가**: `calculate_menu_cost(menu, recipe, ingredient)` → 메뉴·레시피·재료 모두 입력 ✅

### ZONE C (메뉴별 판매 트렌드)
- **사용**: `daily_sales_df` → 일별/요일별/월별 집계 및 전일·전월·전년동기 변화율
- **전부** `daily_sales_items` 기반 ✅

### ZONE D (메뉴 포트폴리오)
- **사용**: `portfolio_df`(판매+메뉴), `roles_dict`, `categories_dict`
- **전부** 사용자 입력 ✅

### ZONE E (메뉴 간 상관관계)
- **사용**: `daily_sales_df` → 일별 메뉴별 판매량 피벗 후 상관계수
- **전부** 판매 입력 기반 ✅

### ZONE F (메뉴 수명주기)
- **사용**: `daily_sales_df`, `menu_df`
- **신메뉴 판별**: “최근 90일 내 **첫 판매일**” 기준 → **메뉴 등록일 미사용**, 판매 데이터만 사용 ✅  
- **추세/성과**: 전반·후반 판매량 비교, 평균 판매량 구간 등 모두 판매 입력 기반 ✅

### ZONE G (수익성, 가격 시뮬레이션)
- **수익성 지수·원가·이익**: `calculate_menu_cost` + `summary_df` → 메뉴·레시피·재료·판매 입력 ✅  
- **가격 시뮬레이션**  
  - **현재가·조정가·원가·판매량**: 전부 입력 기반 ✅  
  - **예외**: **가격 탄력성 -0.5** (가격 +10% → 판매량 -5%) **고정 가정값** ❌ **사용자 입력 아님**

### ZONE H (계절성)
- **사용**: `daily_sales_df` → 월별·계절별 집계, 계절성 지수
- **전부** 판매 입력 기반 ✅  
- **계절 구분**(봄 3–5월 등): 분석 규칙(하드코딩), 사용자 “입력” 아님 → 분석 기준으로서 자연스러움

### ZONE I (최적화 액션)
- **사용**: `monthly_trend_df`, `summary_df`, `portfolio_df`, `lifecycle_df`  
- **전부** 위 ZONE들에서 파생 → 입력 기반 ✅  
- **임계값**(전월 대비 ±20% 등): 분석 기준(하드코딩), 입력 아님

### ZONE J (내보내기)
- **사용**: 각 ZONE 산출 DataFrame들
- **전부** 입력 기반 ✅

---

## 3. “입력하지 않는” 자료 사용 여부

### 3.1 사용자 입력이 **아닌** 것 (비입력)

| 항목 | 용도 | 비고 |
|------|------|------|
| **가격 탄력성 -0.5** | 가격 시뮬레이션 (가격 변화 → 예상 판매량) | 유일한 **비입력 가정값**. 경제학적 보편 가정 사용 |

- 나머지 **모든** 도출 자료는 **사용자가 입력한 데이터**만으로 계산됨.

### 3.2 입력은 아니지만 “분석 규칙”으로 쓰는 것 (임계값 등)

- **신메뉴** 기준: 최근 **90일** 내 첫 판매  
- **급증/급감**: 전일 대비 **±50%**  
- **전월 기준 급증/급감**: **±20%**  
- **수명주기 추세**: 전반·후반 비교 **±10%**  
- **성과 구간**: 평균 일일 판매량 50+ / 20+ / 미만  
- **계절**: 3–5봄, 6–8여름 등  

→ **사용자 입력 자료가 아니라** “분석 시 **기준값**”입니다.  
→ 현재는 코드에 고정돼 있으며, **입력해야 하는 자료**는 아닙니다. (필요 시 나중에 “설정”으로 분리 가능)

### 3.3 “입력해야 하는데 없는” 자료는?

- **메뉴 등록일(추가일)**  
  - 지금 **사용하지 않음**.  
  - “신메뉴”는 **첫 판매일**로만 추정 → **추가 입력 없이** 판매 데이터만으로 처리 ✅  
- 그 외 **판매 메뉴 분석에서 요구하는 추가 입력**은 없음.

---

## 4. 결론

1. **도출 자료 대부분**  
   - **전부 사용자 입력 기반** (메뉴, 판매, 레시피, 재료, 역할/카테고리).  
   - 입력이 없으면 해당 ZONE은 비어 있거나 “데이터 없음” 등으로 처리됨.

2. **유일한 비입력 사용**  
   - **가격 시뮬레이션**의 **가격 탄력성 -0.5**  
   - “입력하지 않는 자료”가 **반드시 있어야** 하는 것은 아니며,  
     **참고용 시뮬레이션**에 쓰는 **가정값**으로 두고 있음.

3. **입력이 없는 자료를 넣어야 하는가?**  
   - **아니오.**  
   - 현재 구조만으로도 **입력 데이터만으로** 판매 메뉴 분석 전 기능 동작 가능.  
   - (선택) 가격 탄력성을 “설정”으로 빼서 사용자 입력 가능하게 하면, **완전 입력 기반**으로 만들 수 있음.

---

## 5. 권장 사항

- **가격 탄력성**  
  - UI에 “가격 탄력성 (기본 -0.5)” 같은 **설정 필드**를 두고,  
    입력하면 그 값을 쓰고, 없으면 -0.5 기본값 사용 → **투명성** 확보.  
- **역할/카테고리**  
  - 미입력 시 **미분류** 비중이 커지는 현재 동작 유지.  
  - “메뉴 포트폴리오 설계실에서 역할·카테고리를 입력하면 더 풍부한 분석” 안내 유지.

---

**작성**: 데이터 소스 및 코드 검토 기반  
**대상 파일**: `ui_pages/sales_analysis.py`
