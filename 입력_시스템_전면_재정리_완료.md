# 입력 시스템 전면 재정리 완료 보고서

**작업 일자**: 2026-01-24  
**목적**: 입력 시스템을 "사장이 데이터를 만드는 시스템"으로 전면 재설계

---

## 1️⃣ 입력의 최상위 개념 정의

### A. 운영 기록 입력 (흘러가는 데이터)
- **오늘 입력**: 매일 매출, 방문자, 판매량, 메모 기록
- **주간 리포트**: 주 1회 운영 상황 정리
- **월간 정산**: 월 1회 실제 성적 확정
- **매장 체크리스트**: 주 1-2회 운영 전반 점검

### B. 구조 기준 입력 (설계의 원본 데이터)
- **목표 매출 구조**: 설계의 기준 데이터 (설계 메뉴에서 업그레이드/시뮬레이션)
- **목표 비용 구조**: 설계의 기준 데이터 (설계 메뉴에서 업그레이드/시뮬레이션)

### C. 매장 자산 입력 (운영 DB / 가장 중요)
- **메뉴 관리**: 가게의 모든 메뉴 등록 및 관리
- **재료 관리**: 사용하는 모든 재료 등록 및 관리
- **레시피 관리**: 메뉴별 레시피와 원가 관리
- **재고 관리**: 재고 현황과 입출고 관리 (향후 추가 예정)

### D. 보정·특수 입력
- **매출 등록**: 과거/수정 - 특정 날짜 매출 보정 또는 추가 입력
- **판매량 등록**: 과거/수정 - 특정 날짜 판매량 보정 또는 추가 입력

---

## 2️⃣ 사이드바 입력 구조 재편

### 변경 전
```
✍ 입력
  - 입력 허브
  - 오늘 입력
  - 점장 마감
  - 매출 보정 입력
  - 판매량 보정 입력
  - 월간 정산 입력
  - 주간 리포트 확인
  - 매장 체크리스트 실시
```

### 변경 후
```
✍ 입력
  - 입력 허브 (항상 노출)
  
⚡ 빠른 입력 (expander, 접혀있음)
  - 오늘 입력(통합)
  - 매장 체크리스트
  - 주간 리포트
  - 월간 정산
  - 목표 매출 구조
  - 목표 비용 구조
  - 메뉴 관리
  - 재료 관리
  - 레시피 관리
  - 매출 등록(과거/수정)
  - 판매량 등록(과거/수정)
```

**구조 원칙**:
- 기본 진입 = 입력 허브
- 숙련자 = 사이드바 펼쳐서 바로 진입

---

## 3️⃣ 입력 허브 전면 개편 (5개 영역)

### A. 오늘 추천 (최상단 고정)

**자동 판단 로직 v2**:
1. 오늘 아무 데이터 없으면 → 오늘 입력(통합)
2. 오늘 매출만 있고 마감 없으면 → 오늘 입력(통합)
3. 오늘 입력 있고 마감 없으면 → 오늘 입력(통합) (점장 마감은 오늘 입력 페이지에서 처리)
4. 7일간 체크리스트 없으면 → 매장 체크리스트
5. 월초 + 이번달 정산 없으면 → 월간 정산

**UI**: 카드형 + 메시지 + 단일 Primary 버튼

### B. 오늘/운영 입력

**"장사하면서 쓰는 입력"** - 흘러가는 데이터를 기록합니다

- **📝 오늘 입력(통합)**: 매일 - 매출, 방문자, 판매량, 메모를 기록합니다
- **📋 매장 체크리스트**: 주 1-2회 - 운영 전반을 점검하고 개선점을 찾습니다
- **📈 주간 리포트**: 주 1회 - 이번 주 운영 상황을 정리합니다
- **📅 월간 정산**: 월 1회 - 실제 성적을 확정하고 정산합니다

각 버튼에 "언제 쓰는지 / 왜 중요한지" 1줄 설명 포함

### C. 매장 기준 입력 (설계의 원본)

**"설계가 가져다 쓰는 기준 데이터"** - 목표와 기준을 설정합니다

- **🎯 목표 매출 구조**: 설계의 기준 데이터입니다. 설계 메뉴에서 업그레이드/시뮬레이션됩니다
- **🧾 목표 비용 구조**: 설계의 기준 데이터입니다. 설계 메뉴에서 업그레이드/시뮬레이션됩니다

### D. 매장 자산 입력 (가장 큰 섹션)

**"이 앱의 뼈대는 여기서 만들어진다"** - 이 가게가 무엇으로 이루어져 있는가를 정의합니다

- **📘 메뉴 관리**: 가게의 모든 메뉴를 등록하고 관리합니다
- **🧺 재료 관리**: 사용하는 모든 재료를 등록하고 관리합니다
- **🧑‍🍳 레시피 관리**: 메뉴별 레시피와 원가를 관리합니다
- **📦 재고 관리**: 재고 현황과 입출고를 관리합니다 (향후 추가 예정)

시각적으로 가장 중요하게 표시 (노란색 강조 박스)

### E. 보정·특수 입력

**"필요할 때만 사용"** - 과거 데이터 수정이나 보정이 필요할 때

- **🧮 매출 등록(과거/수정)**: 과거/수정 - 특정 날짜의 매출을 보정하거나 추가 입력합니다
- **📦 판매량 등록(과거/수정)**: 과거/수정 - 특정 날짜의 판매량을 보정하거나 추가 입력합니다

작고, 연한 UI, "필요할 때만 사용" 문구 포함

---

## 4️⃣ 핵심 문구 통일

### 입력 허브 상단 문구
```
입력은 가게의 현실을 만드는 일입니다.
분석은 해석, 설계는 실험입니다.
```

### 각 버튼 설명
- **언제 하는지**: "매일", "주 1회", "월 1회" 등
- **이게 쌓이면 무엇이 되는지**: "기록합니다", "정리합니다", "확정합니다" 등

---

## 5️⃣ 추천 로직 v2 수정

### 변경 전 (v2)
- P1: 오늘 매출도 없고 기록도 없음
- P2: 오늘 매출/기록은 있는데 마감 없음
- P3: 오늘 마감까지 완료 + 체크리스트 7일 0회
- P4: 월초 + 지난달 정산 미완료

### 변경 후 (v2 - 요구사항 반영)
- P1: 오늘 아무 데이터 없으면 → 오늘 입력(통합)
- P2: 오늘 매출만 있고 마감 없으면 → 오늘 입력(통합)
- P3: 오늘 입력 있고 마감 없으면 → 오늘 입력(통합) (점장 마감은 오늘 입력 페이지에서 처리)
- P4: 7일간 체크리스트 없으면 → 매장 체크리스트
- P5: 월초 + 이번달 정산 없으면 → 월간 정산

**주요 변경**:
- P2 조건 수정: "매출만 있고 마감 없으면" → 오늘 입력(통합) 추천
- P3 조건 수정: "오늘 입력 있고 마감 없으면" → 오늘 입력(통합) 추천 (점장 마감은 오늘 입력 페이지에서 처리)
- P5 조건 수정: "이번달 정산" 확인 (지난달 → 이번달)

---

## 6️⃣ 수정된 파일 목록

### 6.1 app.py

**위치**: 라인 1516-1532, 1582-1615

**변경 내용**:
1. **menu_categories 재구성**:
   - "✍ 입력": 입력 허브만 항상 노출
   - "✍ 입력 (빠른 입력)": expander 내부 항목들 (12개)

2. **사이드바 렌더링 로직 수정**:
   - 입력 카테고리는 특별 처리
   - 입력 허브는 항상 노출
   - 빠른 입력은 expander로 처리

### 6.2 ui_pages/input/input_hub.py

**변경 내용**:
1. **추천 로직 v2 수정**:
   - `_is_current_month_settlement_done()` 함수 추가
   - `_get_today_recommendation()` 로직 수정 (P1~P5)

2. **입력 허브 전면 개편**:
   - 5개 영역으로 재구성
   - 각 버튼에 설명 추가
   - 핵심 문구 통일
   - 매장 자산 입력 섹션 강조

---

## 7️⃣ 기능 영향 없음 체크리스트

### ✅ Page Key 유지
- [x] 모든 라우팅 키 유지
- [x] 모든 내부 이동에서 page key 유지

### ✅ 함수명/파일명 유지
- [x] 함수명 변경 없음
- [x] 파일명 변경 없음
- [x] 모듈 경로 변경 없음

### ✅ DB/테이블명 유지
- [x] 테이블명 변경 없음
- [x] DB 쿼리 변경 없음 (조회만 추가)
- [x] 저장 로직 변경 없음

---

## 8️⃣ 검증 체크리스트

### 사이드바 구조
- [ ] 입력 그룹에 "입력 허브"만 항상 노출됨
- [ ] "⚡ 빠른 입력" expander가 접혀있음
- [ ] Expander 펼치면 12개 항목 표시됨

### 입력 허브 구조
- [ ] A. 오늘 추천 카드가 최상단에 표시됨
- [ ] B. 오늘/운영 입력 섹션이 4개 버튼으로 표시됨
- [ ] C. 매장 기준 입력 섹션이 2개 버튼으로 표시됨
- [ ] D. 매장 자산 입력 섹션이 3개 버튼으로 표시됨
- [ ] E. 보정·특수 입력 섹션이 2개 버튼으로 표시됨

---

## 9️⃣ 변경 전/후 입력 구조 트리

### 변경 전 입력 구조
```
✍ 입력 (사이드바)
  ├─ 입력 허브
  ├─ 오늘 입력
  ├─ 점장 마감
  ├─ 매출 보정 입력
  ├─ 판매량 보정 입력
  ├─ 월간 정산 입력
  ├─ 주간 리포트 확인
  └─ 매장 체크리스트 실시

입력 허브 (버튼 모음)
  ├─ 오늘 추천 (v1)
  ├─ 매일 입력
  ├─ 월 1회 입력
  ├─ 주간·불시
  └─ 보정/과거 입력
```

### 변경 후 입력 구조
```
✍ 입력 (사이드바)
  ├─ 입력 허브 (항상 노출)
  └─ ⚡ 빠른 입력 (expander, 접혀있음)
      ├─ 오늘 입력(통합)
      ├─ 매장 체크리스트
      ├─ 주간 리포트
      ├─ 월간 정산
      ├─ 목표 매출 구조
      ├─ 목표 비용 구조
      ├─ 메뉴 관리
      ├─ 재료 관리
      ├─ 레시피 관리
      ├─ 매출 등록(과거/수정)
      └─ 판매량 등록(과거/수정)

입력 허브 (입력 시스템 홈)
  ├─ A. 오늘 추천 (최상단 고정, v2 로직)
  ├─ B. 오늘/운영 입력 (4개 버튼)
  ├─ C. 매장 기준 입력 (2개 버튼)
  ├─ D. 매장 자산 입력 (3개 버튼, 강조)
  └─ E. 보정·특수 입력 (2개 버튼)
```

---

## 🔟 입력 허브 스크린 구조 설명

### 최상단: 오늘 추천 카드
- 그라데이션 배경 (보라색)
- 추천 메시지 표시
- Primary 버튼 1개 (추천 액션)

### 핵심 문구 박스
- 파란색 배경
- "입력은 가게의 현실을 만드는 일입니다."
- "분석은 해석, 설계는 실험입니다."

### B. 오늘/운영 입력
- 섹션 제목: "📊 오늘/운영 입력"
- 설명: "장사하면서 쓰는 입력 - 흘러가는 데이터를 기록합니다"
- 4개 버튼 (2x2 그리드):
  - 📝 오늘 입력(통합) + 설명
  - 📋 매장 체크리스트 + 설명
  - 📈 주간 리포트 + 설명
  - 📅 월간 정산 + 설명

### C. 매장 기준 입력
- 섹션 제목: "🎯 매장 기준 입력"
- 설명: "설계가 가져다 쓰는 기준 데이터 - 목표와 기준을 설정합니다"
- 2개 버튼 (1x2 그리드):
  - 🎯 목표 매출 구조 + 설명
  - 🧾 목표 비용 구조 + 설명

### D. 매장 자산 입력
- 섹션 제목: "🏗️ 매장 자산 입력"
- 강조 박스 (노란색 배경):
  - "이 앱의 뼈대는 여기서 만들어진다"
  - "이 가게가 무엇으로 이루어져 있는가를 정의합니다"
- 3개 버튼 (2x2 그리드, 4번째는 비어있음):
  - 📘 메뉴 관리 + 설명
  - 🧺 재료 관리 + 설명
  - 🧑‍🍳 레시피 관리 + 설명

### E. 보정·특수 입력
- 섹션 제목: "🔧 보정·특수 입력"
- 설명: "필요할 때만 사용 - 과거 데이터 수정이나 보정이 필요할 때"
- 2개 버튼 (1x2 그리드):
  - 🧮 매출 등록(과거/수정) + 설명
  - 📦 판매량 등록(과거/수정) + 설명

---

## 1️⃣1️⃣ 추천 로직 상세 설명

### P1: 오늘 아무 데이터 없으면
**조건**: `not has_any` (매출, 방문자, 마감 모두 없음)
**추천**: 오늘 입력(통합)
**이유**: 첫 입력을 시작해야 함

### P2: 오늘 매출만 있고 마감 없으면
**조건**: `has_sales and not has_close`
**추천**: 오늘 입력(통합)
**이유**: 매출만 입력했으므로 나머지 입력을 완료해야 함

### P3: 오늘 입력 있고 마감 없으면
**조건**: `has_any and not has_close` (P2 통과 후)
**추천**: 오늘 입력(통합) (점장 마감은 오늘 입력 페이지에서 처리)
**이유**: 입력은 있지만 마감이 없으므로 오늘 입력 페이지에서 마감까지 완료

### P4: 7일간 체크리스트 없으면
**조건**: `has_close and checklist_count == 0` (P1, P2, P3 통과 후)
**추천**: 매장 체크리스트
**이유**: 정기 점검이 필요함

### P5: 월초 + 이번달 정산 없으면
**조건**: `today.day <= 3 and not is_settlement_done` (P1~P4 통과 후)
**추천**: 월간 정산
**이유**: 월초에 이번달 정산을 시작해야 함

### Fallback
**조건**: 예외 발생 또는 모든 조건 통과
**추천**: 오늘 입력(통합)
**이유**: 안전한 기본값

---

## 1️⃣2️⃣ 결과물 체크리스트

- [x] 입력 허브 하나만 봐도 이 앱의 정체성이 보인다
- [x] 메뉴/재료/레시피가 "입력의 핵심"으로 인식된다
- [x] 설계 페이지들이 "입력을 업그레이드하는 곳"으로 자연스럽게 연결된다
- [x] 신규 사장도, 10년차 사장도 입력 허브에서 길을 잃지 않는다
- [x] 사이드바는 "허브 + 숙련자용 바로가기" 구조가 된다

---

**작성일**: 2026-01-24  
**담당**: 입력 시스템 전면 재정리 작업
