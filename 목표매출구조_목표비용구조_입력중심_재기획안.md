# 목표 매출구조 & 목표 비용구조 페이지 입력 중심 재기획안

**작성 일자**: 2026-01-24  
**목적**: 입력 중심으로 페이지 재구성 (분석/설계 기능 제거)

---

## 📋 현재 상태 분석

### 목표 비용구조 페이지 (`target_cost_structure.py`)
**현재 포함 기능**:
- ✅ 비용 항목 입력 (고정비/변동비)
- ✅ 손익분기점 계산 및 표시
- ✅ 목표 매출 입력
- ✅ 평일/주말 매출 비율 설정
- ❌ **목표매출 달성시 비용구조 분석** (분석 기능 - 제거 대상)
- ❌ **월간 집계 표시** (분석 기능 - 제거 대상)

### 목표 매출구조 페이지 (`target_sales_structure.py`)
**현재 포함 기능**:
- ❌ **매출 수준별 비용·영업이익 시뮬레이션** (분석 기능 - 제거 대상)
- ✅ 목표 매출 입력 (비용구조 페이지에서 이미 입력 가능)

---

## 🎯 재기획 방향

### 핵심 원칙
1. **입력에만 집중**: 사용자가 데이터를 입력하는 것에만 집중
2. **분석/설계 제거**: 분석과 설계는 별도 페이지에서 처리
3. **명확한 입력 흐름**: 단계별로 명확하게 입력할 수 있도록 구성
4. **최소한의 계산 표시**: 입력 검증을 위한 기본 계산만 표시

---

## 📝 목표 비용구조 페이지 재기획안

### 페이지 제목
**"목표 비용 구조 입력"** (기존 유지)

### 페이지 구조

#### ZONE A: 기간 선택 & 전월 복사
```
[연도 선택] [월 선택] [📋 전월 데이터 복사]
```
- 기존 기능 유지
- 전월 데이터 복사 기능 유지

---

#### ZONE B: 기본 정보 입력

**1. 목표 매출 입력**
```
🎯 목표 월매출 설정
[목표 월매출 입력 (원)] [💾 목표 저장]
```
- 목표 매출 입력 및 저장
- 저장 버튼으로 `targets` 테이블에 저장

**2. 평일/주말 매출 비율 설정** (선택 사항)
```
📅 평일/주말 매출 비율 설정 (선택)
[평일 매출 비율 (%)] [주말 매출 비율 (%)] [합계 표시]
```
- 입력 검증: 합계가 100%인지 확인
- 저장 기능은 제거 (입력만, 저장은 선택 사항)

---

#### ZONE C: 손익분기점 미리보기 (최소한의 계산)

**조건**: 고정비와 변동비율이 모두 입력된 경우에만 표시

```
📊 손익분기점 계산 결과
[손익분기 월매출: XXX원]
[계산 공식: 고정비 ÷ (1 - 변동비율)]
```

**표시 내용**:
- 손익분기 월매출 금액만 표시
- 계산 공식 안내
- 목표 매출과의 비교는 제거 (분석 기능이므로)

---

#### ZONE D: 비용 구조 입력 (핵심)

**5개 카테고리별 입력 섹션**

**1. 🏢 임차료 (고정비)**
```
🏢 임차료
고정비 (금액 직접 입력)

📋 기존 입력된 항목 (N개)
[항목명] [금액] [✏️] [🗑️]

[새 항목 입력]
[항목명 입력] [금액 입력 (원)] [➕ 추가]

총액: XXX원
```

**2. 👥 인건비 (고정비)**
```
👥 인건비
고정비 (금액 직접 입력)

📋 기존 입력된 항목 (N개)
[항목명] [금액] [✏️] [🗑️]

[새 항목 입력]
[항목명 입력] [금액 입력 (원)] [➕ 추가]

총액: XXX원
```

**3. 🥬 재료비 (변동비)**
```
🥬 재료비
변동비 (매출 대비 비율)

📋 기존 입력된 항목 (N개)
[항목명] [비율 (%)] [✏️] [🗑️]

[새 항목 입력]
[항목명 입력] [매출 대비 비율 (%)] [➕ 추가]

총 비율: XX.XX%
⚠️ 변동비율 합계가 100%를 초과할 수 없습니다.
```

**4. 💡 공과금 (고정비)**
```
💡 공과금
고정비 (금액 직접 입력)

📋 기존 입력된 항목 (N개)
[항목명] [금액] [✏️] [🗑️]

[새 항목 입력]
[항목명 입력] [금액 입력 (원)] [➕ 추가]

총액: XXX원
```

**5. 💳 부가세&카드수수료 (변동비)**
```
💳 부가세&카드수수료
변동비 (매출 대비 비율)

📋 기존 입력된 항목 (N개)
[항목명] [비율 (%)] [✏️] [🗑️]

[새 항목 입력]
[항목명 입력] [매출 대비 비율 (%)] [➕ 추가]

총 비율: XX.XX%
⚠️ 변동비율 합계가 100%를 초과할 수 없습니다.
```

**입력 기능**:
- ✅ 항목 추가 (항목명 + 금액/비율)
- ✅ 항목 수정 (✏️ 버튼)
- ✅ 항목 삭제 (🗑️ 버튼)
- ✅ 카테고리별 총액/총 비율 표시
- ✅ 변동비율 합계 검증 (100% 초과 방지)

---

#### 제거할 기능

1. ❌ **목표매출 달성시 비용구조 분석** (ZONE E)
   - 목표매출 달성시 각 비용 카테고리별 월매출 대비 비율 계산
   - 총 비용 및 이익률 계산
   - 알림 시스템 (변동비율, 고정비, 총 비용률 기준)
   - → 분석 페이지로 이동

2. ❌ **월간 집계 표시** (ZONE F)
   - 카테고리별 집계 테이블
   - 총 고정비 표시
   - → 분석 페이지로 이동

3. ❌ **일일 매출 비교** (평일/주말 일일 매출 상세 계산)
   - 일일 손익분기 매출 계산
   - 일일 목표 매출 계산
   - 일일 영업이익 계산
   - → 분석 페이지로 이동

4. ❌ **손익분기 매출 vs 목표 매출 비교** (상세 비교)
   - 월간 매출 비교 카드
   - 추정 영업이익 계산
   - → 분석 페이지로 이동

---

## 📝 목표 매출구조 페이지 재기획안

### 페이지 제목
**"목표 매출 구조 입력"** (변경)

### 페이지 구조

#### ZONE A: 기간 선택
```
[연도 선택] [월 선택]
```
- 비용구조 페이지와 동일한 기간 선택
- `expense_year`, `expense_month` 세션 상태 공유

---

#### ZONE B: 목표 매출 입력

**1. 목표 매출 입력**
```
🎯 목표 월매출 설정
[목표 월매출 입력 (원)] [💾 목표 저장]
```
- 목표 매출 입력 및 저장
- 저장 버튼으로 `targets` 테이블에 저장
- 비용구조 페이지와 동일한 기능

**2. 목표 매출 구조 입력** (신규)
```
📊 목표 매출 구조 입력
목표 매출을 달성하기 위한 매출 구조를 입력하세요.

[메뉴 카테고리별 목표 매출 비율]
- 메인 메뉴: XX%
- 사이드 메뉴: XX%
- 음료: XX%
- 기타: XX%
합계: XXX% (100%가 되어야 합니다)

[시간대별 목표 매출 비율]
- 점심: XX%
- 저녁: XX%
- 기타: XX%
합계: XXX% (100%가 되어야 합니다)
```

**입력 항목**:
- 메뉴 카테고리별 목표 매출 비율
- 시간대별 목표 매출 비율
- (향후 확장 가능: 요일별, 주간별 등)

**저장 위치**:
- `targets` 테이블 또는 새로운 `target_sales_structure` 테이블

---

#### ZONE C: 입력 현황 요약 (최소한의 표시)

```
📋 입력 현황
- 목표 매출: XXX원
- 비용 구조 입력 완료 여부: ✅ / ⚠️
- 매출 구조 입력 완료 여부: ✅ / ⚠️
```

**표시 내용**:
- 목표 매출 금액
- 비용 구조 입력 완료 여부 (비용구조 페이지에서 입력했는지 확인)
- 매출 구조 입력 완료 여부

---

#### 제거할 기능

1. ❌ **매출 수준별 비용·영업이익 시뮬레이션**
   - 목표매출 - 1,000만원 ~ + 1,500만원 시나리오
   - 각 시나리오별 비용 합계 및 세부내역
   - 추정 영업이익 계산
   - → 분석 페이지로 이동

---

## 🔄 데이터 흐름

### 입력 흐름
```
1. 목표 비용구조 입력
   ↓
   - 고정비 입력 (임차료, 인건비, 공과금)
   - 변동비 입력 (재료비, 부가세&카드수수료)
   - 목표 매출 입력
   ↓
   expense_structure 테이블 저장
   targets 테이블 저장

2. 목표 매출구조 입력
   ↓
   - 목표 매출 입력 (또는 비용구조에서 입력한 값 사용)
   - 매출 구조 입력 (카테고리별, 시간대별 비율)
   ↓
   targets 테이블 저장
   target_sales_structure 테이블 저장 (신규)
```

### 분석/설계 흐름 (별도 페이지)
```
입력된 데이터
   ↓
분석 페이지
   - 목표매출 달성시 비용구조 분석
   - 매출 수준별 시뮬레이션
   - 월간 집계 분석
   ↓
설계 페이지
   - 비용 구조 최적화 제안
   - 매출 구조 최적화 제안
```

---

## 📊 UI/UX 개선 사항

### 1. 입력 중심 레이아웃
- 각 입력 섹션을 명확하게 구분
- 입력 필드를 크게 표시
- 저장 버튼을 명확하게 배치

### 2. 입력 검증 강화
- 실시간 검증 (변동비율 합계, 매출 구조 비율 합계)
- 명확한 에러 메시지
- 입력 완료 상태 표시

### 3. 최소한의 계산 표시
- 손익분기점 계산 결과만 표시 (입력 검증용)
- 상세 분석은 제거

### 4. 입력 가이드
- 각 카테고리별 입력 예시
- 도움말 텍스트 추가

---

## 🗂️ 데이터베이스 스키마

### 기존 테이블
- `expense_structure`: 비용 구조 입력 (유지)
- `targets`: 목표 매출 저장 (유지)

### 신규 테이블 (선택 사항)
```sql
CREATE TABLE target_sales_structure (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    store_id UUID NOT NULL REFERENCES stores(id),
    year INTEGER NOT NULL,
    month INTEGER NOT NULL,
    category_type TEXT NOT NULL, -- 'menu_category' or 'time_period'
    category_name TEXT NOT NULL, -- '메인 메뉴', '점심' 등
    target_ratio NUMERIC NOT NULL, -- 목표 비율 (%)
    notes TEXT,
    created_at TIMESTAMP DEFAULT NOW(),
    updated_at TIMESTAMP DEFAULT NOW(),
    UNIQUE(store_id, year, month, category_type, category_name)
);
```

---

## ✅ 구현 체크리스트

### 목표 비용구조 페이지
- [ ] ZONE A: 기간 선택 & 전월 복사 (유지)
- [ ] ZONE B: 기본 정보 입력 (목표 매출, 평일/주말 비율)
- [ ] ZONE C: 손익분기점 미리보기 (최소한의 계산)
- [ ] ZONE D: 비용 구조 입력 (5개 카테고리)
- [ ] 제거: 목표매출 달성시 비용구조 분석
- [ ] 제거: 월간 집계 표시
- [ ] 제거: 일일 매출 비교
- [ ] 제거: 손익분기 매출 vs 목표 매출 상세 비교

### 목표 매출구조 페이지
- [ ] ZONE A: 기간 선택
- [ ] ZONE B: 목표 매출 입력
- [ ] ZONE B-2: 목표 매출 구조 입력 (신규)
- [ ] ZONE C: 입력 현황 요약
- [ ] 제거: 매출 수준별 비용·영업이익 시뮬레이션

---

## 🎯 기대 효과

### 사용자 경험
- ✅ 입력에만 집중하여 혼란 감소
- ✅ 명확한 입력 흐름으로 사용성 향상
- ✅ 분석과 설계는 별도 페이지에서 처리하여 역할 분리

### 개발 효율
- ✅ 페이지 역할이 명확해져 유지보수 용이
- ✅ 입력 페이지와 분석 페이지 분리로 코드 구조 개선

---

**작성일**: 2026-01-24  
**담당**: 목표 매출구조 & 목표 비용구조 페이지 재기획
