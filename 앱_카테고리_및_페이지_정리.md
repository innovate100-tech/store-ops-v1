# 매장 운영 시스템 - 카테고리 및 페이지 정리

## 📋 개요
이 문서는 사용자 입장에서 앱의 카테고리 구조와 각 페이지의 역할을 정리한 분석 문서입니다.

---

## 🏗️ 카테고리 구조

앱은 **6개의 주요 카테고리**로 구성되어 있으며, 각 카테고리는 특정 업무 영역을 담당합니다.

### 1. 🏠 사장 계기판
**목적**: 매장 운영의 핵심 지표를 한눈에 확인

#### 페이지
- **홈** (`home.py`)
  - **역할**: 사장이 매일 확인해야 할 핵심 정보 제공
  - **주요 섹션**:
    1. **상단 성장 단계 메시지**: DAY1/DAY3/DAY7 단계별 안내
    2. **상태판**: 
       - 이번 달 매출 (누적 금액)
       - 마감률 및 연속 마감 스트릭 (마감된 일수/전체 일수, 연속 마감 일수)
    3. **시작 미션 3개**: 
       - 미션 1: 메뉴 3개 등록하기
       - 미션 2: 점장마감 3회 하기
       - 미션 3: 이번 달 성적표 1회 만들기
       - 진행률 바 및 완료 보상 문장 표시
    4. **핵심 숫자 카드**: 
       - 오늘 매출
       - 이번 달 매출
       - 객단가
       - 이번 달 이익
    5. **오늘 하나만 추천**: 
       - 데이터 단계(LEVEL 0~3)에 따른 추천 액션
       - 자동 코치 모드 활성화 시 "코치의 한 가지 제안"으로 표시
    6. **문제 TOP3 / 잘한 점 TOP3**: 
       - 룰 기반 자동 분석
       - 각 항목별 상세 페이지로 이동 버튼
    7. **이상 징후**: 
       - 조기경보 시스템 (최대 3개)
       - 매출 감소, 마감 누락, 판매량 급감 등 감지
    8. **우리 가게 숫자 구조**: 
       - 고정비, 변동비율, 손익분기점 매출
       - 매출 구간별 예상 이익 테이블
       - 실제정산 또는 목표 비용구조 기준으로 표시
    9. **이번 달 운영 메모**: 
       - daily_close에서 메모 최신 5개 표시
  - **특징**:
    - 데이터 단계(LEVEL 0~3)에 따라 화면 구성 변경
    - DAY0 전용 홈 화면 (데이터 없을 때)
    - 자동 코치 모드 (미션 3개 완료 시 활성화)
    - 사장 단계 판별 (DAY1/DAY3/DAY7)
  - **사용 시점**: 매일 아침 첫 화면으로 확인

---

### 2. 📋 오늘 마감
**목적**: 일일 영업 마감 작업

#### 페이지
- **점장 마감** (`manager_close.py`)
  - **역할**: 하루 영업 종료 후 공식 기록 입력
  - **주요 섹션**:
    1. **공식 입력 안내 박스**: 점장마감이 공식 기록임을 안내
    2. **마감 입력 폼**:
       - 날짜 선택
       - 매출 입력 (카드매출, 현금매출, 총매출)
       - 방문자 수 입력
       - 메뉴별 판매량 입력 (동적 메뉴 목록)
       - 특이사항 입력 (issues)
       - 운영 메모 입력 (memo)
    3. **기존 마감 확인**: 
       - 선택한 날짜에 이미 마감 기록이 있는지 확인
       - 판매량 보정(overrides) 존재 여부 경고
    4. **마감 완료 후 요약**:
       - 총매출, 방문자수, 객단가, 판매 메뉴 수 카드
       - 판매량 TOP 3 메뉴 표시
  - **특징**:
    - 같은 날짜로 다시 입력 시 기존 데이터 자동 업데이트
    - 판매량 보정이 있으면 보정값이 최종 적용됨
    - 저장 성공 시 풍선 애니메이션 표시
  - **사용 시점**: 매일 영업 종료 후 (가장 중요한 일일 작업)

---

### 3. 🛒 운영(내일 장사 준비)
**목적**: 다음 영업일을 위한 발주 및 재고 관리

#### 페이지
- **발주 관리** (`order_management.py`)
  - **역할**: 재료 발주 및 재고 관리
  - **주요 탭 구조**:
    1. **🛡️ 안전재고 등록**: 
       - 재료별 안전재고 설정
       - 발주단위 및 변환비율 고려
    2. **📦 현재 재고 현황**: 
       - 재료별 현재고 표시
       - 안전재고 대비 부족 여부 확인
    3. **🛒 발주 추천**: 
       - 재기획 중 (현재 비워둠)
    4. **📋 진행 현황**: 
       - 재기획 중 (현재 비워둠)
    5. **🏢 공급업체**: 
       - 재기획 중 (현재 비워둠)
    6. **📊 발주 분석**: 
       - 재기획 중 (현재 비워둠)
  - **사용 시점**: 발주가 필요한 시점 (보통 주 1-2회)

- **재료 사용량 집계** (`ingredient_usage_summary.py`)
  - **역할**: 판매량 기반 재료 소비량 계산
  - **주요 섹션**:
    1. **기간 선택**: 시작일/종료일 선택
    2. **사용 단가 TOP 10 재료**: 
       - 순위, 재료명, 총 사용량, 총 사용단가, 비율, 누적 비율, ABC 등급
    3. **전체 재료 사용 단가 순위 (ABC 분석)**: 
       - 모든 재료의 사용 단가 순위표
       - ABC 등급별 통계 (A/B/C 등급별 재료 수, 총 사용단가, 비율 합계)
  - **특징**:
    - 판매량(daily_sales_items) × 레시피(recipes)로 재료 사용량 계산
    - 재료 단가와 조인하여 총 사용 단가 계산
    - ABC 분석으로 재료 중요도 파악
  - **사용 시점**: 발주 전 재료 소비량 확인 시

---

### 4. 📊 분석(원인 찾기)
**목적**: 매출, 판매, 원가 등 운영 데이터 분석

#### 페이지
- **통합 대시보드** (`dashboard.py`)
  - **역할**: 종합적인 운영 지표 대시보드
  - **주요 섹션** (모듈화된 구조):
    1. **진단 정보**: 데이터 로드 상태 확인
    2. **손익분기 섹션**: 손익분기 매출 분석
    3. **매출 섹션**: 매출 트렌드 및 분석
    4. **메뉴 섹션**: 메뉴별 성과 분석
  - **특징**:
    - 모듈화된 구조 (context, data_loaders, metrics, sections)
    - 성능 측정 기능 포함
  - **사용 시점**: 주기적인 성과 점검 시

- **매출 관리** (`sales_management.py`)
  - **역할**: 매출 데이터 분석 및 관리
  - **주요 섹션**:
    1. **이번달 요약 (KPI 카드)**: 
       - 이번달 누적 매출, 평균 일일 매출
       - 이번달 총 방문자, 평균 객단가
       - 목표 달성률
    2. **기간별 비교 분석**: 
       - 전월 대비 (매출, 방문자 변화율)
       - 작년 동월 대비
       - 주간 비교 (이번 주 vs 지난 주)
    3. **요일별 패턴 분석**: 
       - 요일별 평균매출, 총매출, 평균방문자, 객단가
       - 최고/최저 요일 표시
    4. **목표 달성 현황**: 
       - 목표 매출, 현재 누적 매출
       - 일평균 목표/실적
       - 예상 월 매출 및 달성률
       - 남은 일수 기준 필요 일평균
    5. **매출 트렌드**: 
       - 최근 7일 vs 최근 30일 평균 비교
       - 트렌드 변화율
    6. **알림 및 경고**: 
       - 목표 대비 저조한 날짜
       - 전일 대비 급락
       - 연속 저조일
       - 월말 목표 달성 위험
    7. **월별 요약 (최근 6개월)**: 
       - 월별 영업일수, 월총매출, 일평균매출
       - 월총방문자, 월별객단가, 전월대비 성장률
    8. **예상 매출 및 목표 달성 가능성**: 
       - 이번달 예상 총 매출
       - 예상 목표 달성률
       - 필요 일평균
    9. **저장된 매출 내역**: 
       - 날짜, 매장, 카드매출, 현금매출, 총매출, 방문자수 표시
    10. **이달 일일 매출과 방문자 사이의 연관성**: 
        - 상관계수 계산 (피어슨 상관계수)
        - 상관관계 해석 (강한 양의 상관관계 등)
        - 일일 매출/방문자수 표
  - **특징**:
    - SSOT 함수(load_monthly_sales_total) 사용으로 데이터 일관성 유지
    - 매출 새로고침 버튼으로 캐시 무효화 가능
  - **사용 시점**: 매출 분석이 필요할 때

- **판매 관리** (`sales_analysis.py`)
  - **역할**: 메뉴별 판매량 분석
  - **주요 섹션**:
    1. **분석 기간 선택**: 시작일/종료일 선택
    2. **기간 내 요약 (KPI 카드)**: 
       - 총 판매량, 총 매출, 총 원가, 총 이익
       - 일평균 판매량
    3. **판매 ABC 분석**: 
       - 메뉴별 매출 비율 및 누계 비율
       - ABC 등급 부여 (A: 상위 70%, B: 70-90%, C: 90% 이상)
       - 원가, 총판매원가, 이익, 이익률, 원가율 표시
    4. **인기 메뉴 TOP 10**: 
       - 순위, 메뉴명, 판매수량, 매출, 비율, ABC 등급
    5. **수익성 분석**: 
       - 최고 수익성 메뉴 (이익률 기준 TOP 5)
       - 저수익성 메뉴 (이익률 30% 미만)
    6. **판매 트렌드 분석**: 
       - 최근 7일 vs 최근 30일 평균 판매량 비교
       - 일별 판매량 추이 표
    7. **요일별 인기 메뉴**: 
       - 요일별 TOP 3 메뉴 표시
    8. **메뉴별 성장률 분석**: 
       - 기간을 반으로 나눠 전반기/후반기 비교
       - 성장률 TOP 10 메뉴
  - **특징**:
    - 판매량 × 판매가로 매출 계산
    - 레시피/재료 데이터가 있으면 원가 및 이익 계산
    - ABC 분석으로 메뉴 중요도 파악
  - **사용 시점**: 메뉴 판매 성과 확인 시

- **원가 파악** (`cost_overview.py`)
  - **역할**: 메뉴별 원가 계산 및 분석
  - **주요 기능**:
    - 메뉴, 레시피, 재료 데이터 기반 원가 계산
    - 원가율 분석 (원가/판매가 × 100)
    - 원가 경고 (원가율 35% 이상 메뉴 표시)
  - **데이터 요구사항**:
    - 메뉴 마스터 (메뉴명, 판매가)
    - 레시피 (메뉴명, 재료명, 사용량)
    - 재료 마스터 (재료명, 단위, 단가)
  - **사용 시점**: 메뉴 가격 정책 수립 시

---

### 5. 🧾 성적표(월간)
**목적**: 월간 목표 설정 및 실제 성과 평가

#### 페이지
- **목표 비용구조** (`target_cost_structure.py`)
  - **역할**: 월간 비용 목표 설정 및 관리
  - **주요 섹션**:
    1. **기간 선택 및 전월 데이터 복사**: 
       - 연도/월 선택
       - 전월 데이터 복사 버튼
    2. **손익분기점 계산 및 상단 표시**: 
       - 고정비, 변동비율, 손익분기점 매출 자동 계산
       - 목표 매출 설정
    3. **비용 항목 입력**: 
       - 카테고리별 비용 입력 (임차료, 인건비, 재료비, 공과금, 부가세&카드수수료)
       - 각 항목별 금액 또는 비율 입력
       - 항목 추가/수정/삭제
  - **특징**:
    - 공식 엔진 함수 사용 (get_fixed_costs, get_variable_cost_ratio, calculate_break_even_sales)
    - 전월 데이터 복사 기능으로 입력 편의성 향상
    - 손익분기점 자동 계산
  - **사용 시점**: 매월 초 목표 설정 시

- **목표 매출구조** (`target_sales_structure.py`)
  - **역할**: 목표 매출 대비 실제 성과 분석
  - **주요 섹션**:
    1. **매출 수준별 비용·영업이익 시뮬레이션**: 
       - 목표 매출 기준 ±500만원, ±1,000만원, ±1,500만원 시나리오
       - 각 시나리오별 매출, 비용 합계 및 세부내역, 추정 영업이익 표시
       - 5대 비용 세부 계산 (임차료, 인건비, 공과금, 재료비, 부가세&카드수수료)
  - **특징**:
    - 비용구조 페이지의 고정비/변동비율 기반 계산
    - 목표 매출 설정 필요
    - 다양한 매출 시나리오로 이익 예측
  - **사용 시점**: 월간 성과 평가 시

- **실제정산** (`settlement_actual.py`)
  - **역할**: 월간 실제 정산 데이터 입력 및 관리
  - **주요 섹션**:
    1. **기간 선택**: 연도/월 선택
    2. **정산 상태 관리**: 
       - draft/final 상태 설정
       - 이전 달 데이터 복사
    3. **비용 항목 입력**: 
       - 템플릿 기반 비용 항목 자동 로드
       - 카테고리별 입력 (임차료, 인건비, 재료비, 공과금, 부가세&카드수수료)
       - 입력 타입: 금액(amount) 또는 비율(rate)
       - 항목별 금액/비율 입력
    4. **자동 계산**: 
       - 고정비 합계
       - 변동비 계산 (매출 × 변동비율)
       - 총 비용 계산
       - 손익 계산 (매출 - 총 비용)
    5. **템플릿 관리**: 
       - 비용 항목 템플릿 저장/로드
       - 템플릿 추가/수정/삭제
  - **특징**:
    - 템플릿 기반 구조로 입력 편의성 향상
    - draft/final 상태 관리로 정산 진행 상황 추적
    - 저장된 값 자동 복원 기능
  - **사용 시점**: 매월 말 정산 작업 시

- **주간 리포트** (`weekly_report.py`)
  - **역할**: 주간 운영 리포트 생성
  - **주요 섹션**:
    1. **리포트 입력 폼**: 시작일/종료일 선택
    2. **리포트 생성**: 
       - PDF 형식으로 리포트 생성
       - 포함 내용: 총매출, 일평균 매출, 방문자수, 매출 vs 방문자 추세 차트
       - 메뉴별 판매 TOP 10, 재료 사용량 TOP 10, 발주 추천 TOP 10
    3. **생성된 리포트 목록**: 
       - 최근 10개 리포트 표시
       - 파일명, 크기, 생성일시
       - PDF 다운로드 버튼
  - **사용 시점**: 주간 리포트 작성 시

---

### 6. ⚙️ 관리/보정(예외)
**목적**: 기본 데이터 관리 및 예외 상황 처리

#### 페이지
- **매출 보정** (`sales_entry.py`)
  - **역할**: 과거 매출 입력 및 보정
  - **주요 섹션**:
    1. **보정 도구 안내**: 일반적인 매출 입력은 점장마감 사용 안내
    2. **매출 입력**: 
       - 단일 입력 또는 일괄 입력 모드
       - 날짜, 매장, 카드매출, 현금매출, 총매출 입력
    3. **방문자 수 입력**: 
       - 단일 입력 또는 일괄 입력 모드
       - 날짜, 방문자수 입력
    4. **저장 결과 표시**: 
       - 성공/경고 메시지 표시
       - 저장된 데이터 요약
  - **특징**:
    - 점장마감과 구분되는 보정 전용 화면
    - 일괄 입력 지원으로 과거 데이터 입력 효율화
  - **사용 시점**: 과거 데이터 입력 또는 오류 보정 시

- **판매량 보정** (`sales_volume_entry.py`)
  - **역할**: 과거 판매량 입력 및 보정
  - **주요 섹션**:
    1. **보정 도구 안내**: 점장마감 이후 판매량 수정용 안내
    2. **일일 판매 입력 (전 메뉴 일괄 입력)**: 
       - 판매 날짜 선택
       - 마감 존재 여부 확인 및 안내
       - 모든 메뉴의 판매 수량을 3열 그리드로 한 번에 입력
       - 0은 미판매로 처리
       - 판매량 보정 저장 (점장마감 판매량보다 우선 적용)
  - **특징**:
    - 점장마감보다 우선 적용되는 보정 기능
    - 마감된 날짜에도 수정 가능
    - 일괄 입력으로 효율적인 보정 작업
  - **사용 시점**: 점장마감 이후 판매량 수정 또는 과거 데이터 입력 시

- **메뉴 등록** (`menu_management.py`)
  - **역할**: 메뉴 정보 관리
  - **주요 섹션**:
    1. **입력 모드 선택**: 단일 입력 / 일괄 입력
    2. **메뉴 입력 폼**: 
       - 메뉴명, 판매가 입력
       - 일괄 입력 시 여러 메뉴 동시 입력 (최대 개수 설정 가능)
    3. **메뉴 목록 및 관리**: 
       - 등록된 메뉴 목록 표시
       - 메뉴 수정/삭제 기능
       - 메뉴 카테고리 관리
  - **특징**:
    - 일괄 입력으로 초기 설정 효율화
    - 저장 후 입력 필드 자동 초기화
  - **사용 시점**: 신메뉴 추가 또는 메뉴 정보 변경 시

- **재료 등록** (`ingredient_management.py`)
  - **역할**: 재료 정보 관리
  - **주요 섹션**:
    1. **재료 입력 폼**: 
       - 재료명, 단위, 단가 입력
       - 발주단위 및 변환비율 설정 (발주 시 사용)
    2. **재료 목록 및 관리**: 
       - 등록된 재료 목록 표시
       - 재료 수정/삭제 기능
    3. **진단 기능** (개발 모드): 
       - DB 연결 상태 확인
       - 쿼리 실행 결과 확인
  - **특징**:
    - 발주단위와 변환비율로 발주 관리와 연동
    - 단위와 단가로 원가 계산에 활용
  - **사용 시점**: 신규 재료 추가 또는 재료 정보 변경 시

- **레시피 등록** (`recipe_management.py` - app.py 내장)
  - **역할**: 메뉴별 레시피(재료 사용량) 관리
  - **주요 섹션**:
    1. **레시피 일괄 등록**: 
       - 메뉴 선택
       - 등록할 재료 개수 선택 (최대 30개)
       - 재료명 검색 기능
       - 재료별 사용량 입력
       - 조리방법 입력 (줄글로 입력)
       - 일괄 저장
    2. **레시피 검색 및 수정**: 
       - 메뉴별 레시피 조회
       - 메뉴 정보 카드 (판매가, 원가, 원가율)
       - 구성 재료 및 사용량 테이블
       - 조리방법 표시
       - 재료별 사용량 수정/삭제
  - **특징**:
    - 컴팩트한 엑셀 스타일 입력 UI
    - 재료 검색 기능으로 입력 편의성 향상
    - 조리방법 저장 기능
    - 원가 자동 계산 및 표시
  - **사용 시점**: 신메뉴 레시피 입력 또는 레시피 변경 시

- **직원 연락망** (`staff_contacts.py`)
  - **역할**: 직원 연락처 관리
  - **주요 섹션**:
    1. **직원 추가**: 이름, 역할, 연락처 입력
    2. **직원 목록**: 등록된 직원 정보 표시 및 수정/삭제
  - **특징**:
    - 임시 세션 상태 기반 (추후 DB 연결 예정)
  - **사용 시점**: 직원 정보 관리 시

- **협력사 연락망** (`vendor_contacts.py`)
  - **역할**: 협력사(공급업체) 연락처 관리
  - **주요 섹션**:
    1. **협력사 추가**: 업체명, 담당자, 연락처, 유형(재료 공급/배달/기타), 메모 입력
    2. **협력사 목록**: 등록된 협력사 정보 표시 및 수정/삭제
  - **특징**:
    - 임시 세션 상태 기반 (추후 DB 연결 예정)
    - 업체 유형별 분류
  - **사용 시점**: 협력사 정보 관리 시

- **게시판** (`board.py`)
  - **역할**: 내부 공지사항 및 메모 관리
  - **주요 섹션**:
    1. **게시글 작성**: 제목, 내용 입력
    2. **게시글 목록**: 작성자, 작성일시, 제목, 내용 표시
    3. **게시글 수정/삭제**: 각 게시글별 수정/삭제 기능
  - **특징**:
    - 임시 세션 상태 기반 (추후 DB 연결 예정)
    - 내부 커뮤니케이션 용도
  - **사용 시점**: 공지사항 작성 또는 메모 필요 시

---

## 🔄 일반적인 사용 흐름

### 일일 작업 흐름
1. **홈** → 오늘의 핵심 지표 확인
2. **점장 마감** → 하루 영업 종료 후 마감 입력

### 주간 작업 흐름
1. **발주 관리** → 재료 발주
2. **재료 사용량 집계** → 발주 계획 수립
3. **통합 대시보드** → 주간 성과 점검

### 월간 작업 흐름
1. **목표 비용구조** → 월간 목표 설정 (월초)
2. **실제정산** → 월간 실제 정산 입력 (월말)
3. **목표 매출구조** → 목표 대비 성과 분석 (월말)

### 초기 설정 및 관리
1. **메뉴 등록** → 메뉴 정보 입력
2. **재료 등록** → 재료 정보 입력
3. **레시피 등록** → 메뉴별 레시피 입력
4. **직원 연락망** / **협력사 연락망** → 연락처 정보 입력

---

## 📌 주요 특징

### 데이터 흐름
- **점장 마감**이 모든 일일 데이터의 출발점
- **판매량 등록** → **재료 사용량 집계** → **발주 관리**로 이어지는 재고 관리 흐름
- **목표 비용구조** → **실제정산** → **목표 매출구조**로 이어지는 월간 성과 관리 흐름

### 페이지 역할 구분
- **일상 작업**: 홈, 점장 마감
- **분석/점검**: 통합 대시보드, 매출 관리, 판매 관리, 원가 파악
- **계획/설정**: 목표 비용구조, 목표 매출구조
- **실적 입력**: 실제정산
- **기초 데이터**: 메뉴 등록, 재료 등록, 레시피 등록
- **보정/예외**: 매출 보정, 판매량 보정

---

## 💡 사용자 입장에서의 권장 사용법

1. **첫 사용 시**: 메뉴 등록 → 재료 등록 → 레시피 등록 순서로 기본 데이터 입력
2. **매일**: 홈 확인 → 점장 마감 입력
3. **주기적으로**: 발주 관리, 재료 사용량 집계로 발주 계획 수립
4. **월초**: 목표 비용구조에서 목표 설정
5. **월말**: 실제정산 입력 후 목표 매출구조에서 성과 분석
6. **필요 시**: 통합 대시보드, 매출 관리, 판매 관리, 원가 파악으로 심층 분석
