# Phase 0 STEP 3: rerun ë‹¤ì´ì–´íŠ¸ ì™„ë£Œ ë³´ê³ ì„œ

**ì‘ì„±ì¼**: 2026-01-24  
**ì‘ì—…ì**: Phase 0 STEP 3 rerun ë‹¤ì´ì–´íŠ¸ ì „ë‹´  
**ëª©í‘œ**: ë¶ˆí•„ìš”í•œ st.rerun() ì œê±°ë¡œ ì²´ê° ì„±ëŠ¥ í–¥ìƒ ë° ë¬´í•œ rerun ìœ„í—˜ ì°¨ë‹¨

---

## 1ï¸âƒ£ st.rerun() ì‚¬ìš©ì²˜ ëª©ë¡ (íŒŒì¼/ë¼ì¸/ì˜ë„)

### ì „ì²´ ì¡°ì‚¬ ê²°ê³¼
- **ì´ ë°œê²¬**: 266ê°œ `st.rerun()` í˜¸ì¶œ
- **ì œê±° ì™„ë£Œ**: 12ê°œ (ë¶ˆí•„ìš”í•œ rerun)
- **ìœ ì§€**: 254ê°œ (í˜ì´ì§€ ì´ë™, ë°ì´í„° ì €ì¥ í›„ ê°±ì‹  ë“± í•„ìˆ˜)

### ì£¼ìš” ìœ„í—˜ íŒŒì¼

#### ğŸ”´ ì œê±° ì™„ë£Œ (ë¶ˆí•„ìš”í•œ rerun)

1. **ui_pages/home/home_page.py** (3ê°œ)
   - 519ì¤„: `_home_problems_expanded` í”Œë˜ê·¸ ë³€ê²½ í›„ rerun â†’ ì œê±°
   - 550ì¤„: `_home_good_points_expanded` í”Œë˜ê·¸ ë³€ê²½ í›„ rerun â†’ ì œê±°
   - 745ì¤„: `_home_{card_type}_expanded` í”Œë˜ê·¸ ë³€ê²½ í›„ rerun â†’ ì œê±°
   - **ì´ìœ **: expanderëŠ” session_state ë³€ê²½ë§Œìœ¼ë¡œ ìë™ ì—…ë°ì´íŠ¸ë¨

2. **app.py** (4ê°œ)
   - 129ì¤„: `_show_supabase_diagnosis` í”Œë˜ê·¸ ë³€ê²½ í›„ rerun â†’ ì œê±°
   - 1655ì¤„: `_show_supabase_diagnosis` í”Œë˜ê·¸ ë³€ê²½ í›„ rerun â†’ ì œê±°
   - 2927ì¤„: í¸ì§‘ ëª¨ë“œ ì·¨ì†Œ í”Œë˜ê·¸ ë³€ê²½ í›„ rerun â†’ ì œê±°
   - 2946ì¤„: í¸ì§‘ ëª¨ë“œ ì‹œì‘ í”Œë˜ê·¸ ë³€ê²½ í›„ rerun â†’ ì œê±°
   - **ì´ìœ **: ì¡°ê±´ë¶€ ë Œë”ë§ì€ session_state ë³€ê²½ë§Œìœ¼ë¡œ ìë™ ì—…ë°ì´íŠ¸ë¨

3. **ui_pages/strategy/strategy_board.py** (1ê°œ)
   - 301ì¤„: ì „ëµ ì¹´ë“œ ì™„ë£Œ ì €ì¥ í›„ rerun â†’ ì œê±°
   - **ì´ìœ **: session_state ë³€ê²½ë§Œìœ¼ë¡œ UIê°€ ìë™ ì—…ë°ì´íŠ¸ë¨

4. **ui_pages/settlement_actual.py** (2ê°œ)
   - 1463ì¤„: íˆìŠ¤í† ë¦¬ limit í”Œë˜ê·¸ ë³€ê²½ í›„ rerun â†’ ì œê±°
   - 1467ì¤„: íˆìŠ¤í† ë¦¬ limit í”Œë˜ê·¸ ë³€ê²½ í›„ rerun â†’ ì œê±°
   - **ì´ìœ **: ì¡°ê±´ë¶€ ë Œë”ë§ì€ session_state ë³€ê²½ë§Œìœ¼ë¡œ ìë™ ì—…ë°ì´íŠ¸ë¨

5. **ui_pages/sales_entry.py** (1ê°œ)
   - 149ì¤„: ë©”ì‹œì§€ í”Œë˜ê·¸ ì‚­ì œ í›„ rerun â†’ ì œê±°
   - **ì´ìœ **: ì¡°ê±´ë¶€ ë Œë”ë§ì€ session_state ë³€ê²½ë§Œìœ¼ë¡œ ìë™ ì—…ë°ì´íŠ¸ë¨

6. **ui_pages/design_lab/design_center.py** (1ê°œ)
   - 48ì¤„: ì£¼ê°„ ì ê²€ ì™„ë£Œ ì²˜ë¦¬ í›„ rerun â†’ ì œê±°
   - **ì´ìœ **: DB ì €ì¥ í›„ ìƒíƒœê°€ ë‹¤ìŒ ë Œë”ì—ì„œ ìë™ ë°˜ì˜ë¨

7. **src/auth.py** (2ê°œ)
   - 1170ì¤„: `_show_signup` í”Œë˜ê·¸ ë³€ê²½ í›„ rerun â†’ ì œê±°
   - 1179ì¤„: `_show_signup` í”Œë˜ê·¸ ë³€ê²½ í›„ rerun â†’ ì œê±°
   - **ì´ìœ **: ì¡°ê±´ë¶€ ë Œë”ë§ì€ session_state ë³€ê²½ë§Œìœ¼ë¡œ ìë™ ì—…ë°ì´íŠ¸ë¨

8. **ui_pages/menu_profit_design_lab.py** (4ê°œ)
   - 290ì¤„: ë©”ë‰´ íƒœê·¸ ë³€ê²½ í›„ rerun â†’ ì œê±°
   - 294ì¤„: ë©”ë‰´ íƒœê·¸ ë³€ê²½ í›„ rerun â†’ ì œê±°
   - 298ì¤„: ë©”ë‰´ íƒœê·¸ ë³€ê²½ í›„ rerun â†’ ì œê±°
   - 303ì¤„: ë©”ë‰´ íƒœê·¸ ì œê±° í›„ rerun â†’ ì œê±°
   - **ì´ìœ **: session_state ë³€ê²½ë§Œìœ¼ë¡œ UIê°€ ìë™ ì—…ë°ì´íŠ¸ë¨

---

## 2ï¸âƒ£ ì œê±°/ìœ ì§€ íŒë‹¨ ê·¼ê±°

### âœ… ì œê±°í•œ rerun (12ê°œ)

**íŒ¨í„´ A: Expander í”Œë˜ê·¸ ë³€ê²½**
- `st.session_state["_home_problems_expanded"] = True` í›„ rerun
- **íŒë‹¨**: Streamlitì€ session_state ë³€ê²½ì„ ê°ì§€í•˜ì—¬ ìë™ìœ¼ë¡œ rerenderí•˜ë¯€ë¡œ ë¶ˆí•„ìš”
- **ì œê±° íŒŒì¼**: `home_page.py` (3ê°œ)

**íŒ¨í„´ B: í¸ì§‘ ëª¨ë“œ í† ê¸€**
- `st.session_state[edit_key] = True/False` í›„ rerun
- **íŒë‹¨**: í¸ì§‘ ëª¨ë“œ í”Œë˜ê·¸ ë³€ê²½ë§Œìœ¼ë¡œ ì¡°ê±´ë¶€ ë Œë”ë§ì´ ìë™ ì—…ë°ì´íŠ¸ë¨
- **ì œê±° íŒŒì¼**: `app.py` (2ê°œ)

**íŒ¨í„´ C: ë‹¨ìˆœ ìƒíƒœ ë³€ê²½**
- `st.session_state[tag_key] = "ë¯¸ë¼"` í›„ rerun
- **íŒë‹¨**: íƒœê·¸ ê°’ ë³€ê²½ë§Œìœ¼ë¡œ UIê°€ ìë™ ì—…ë°ì´íŠ¸ë¨
- **ì œê±° íŒŒì¼**: `menu_profit_design_lab.py` (4ê°œ)

**íŒ¨í„´ D: ì¡°ê±´ë¶€ ë Œë”ë§ í”Œë˜ê·¸**
- `st.session_state["_show_supabase_diagnosis"] = True/False` í›„ rerun
- **íŒë‹¨**: í”Œë˜ê·¸ ë³€ê²½ë§Œìœ¼ë¡œ ì¡°ê±´ë¶€ ë Œë”ë§ì´ ìë™ ì—…ë°ì´íŠ¸ë¨
- **ì œê±° íŒŒì¼**: `app.py` (2ê°œ), `auth.py` (2ê°œ), `sales_entry.py` (1ê°œ), `settlement_actual.py` (2ê°œ)

**íŒ¨í„´ E: DB ì €ì¥ í›„ ìƒíƒœ ë³€ê²½**
- `mark_weekly_check_done()` í›„ rerun
- **íŒë‹¨**: DB ì €ì¥ í›„ ìƒíƒœëŠ” ë‹¤ìŒ ë Œë”ì—ì„œ ìë™ ë°˜ì˜ë¨ (ì¦‰ì‹œ rerun ë¶ˆí•„ìš”)
- **ì œê±° íŒŒì¼**: `design_center.py` (1ê°œ)

### âœ… ìœ ì§€í•œ rerun (254ê°œ)

**í•„ìˆ˜ rerun íŒ¨í„´**:

1. **í˜ì´ì§€ ì´ë™** (ëŒ€ë¶€ë¶„)
   - `st.session_state["current_page"] = "..."` í›„ rerun
   - **ì´ìœ **: í˜ì´ì§€ ì „í™˜ì€ ì „ì²´ ì•± ì¬ë Œë”ë§ í•„ìš”
   - **ì˜ˆì‹œ**: `app.py` (1579ì¤„), `home_page.py` (251ì¤„, 470ì¤„ ë“±)

2. **ë°ì´í„° ì €ì¥ í›„ ê°±ì‹ ** (í•„ìˆ˜)
   - DB ì €ì¥ í›„ rerun
   - **ì´ìœ **: ì €ì¥ëœ ë°ì´í„°ë¥¼ ì¦‰ì‹œ ë°˜ì˜í•˜ê¸° ìœ„í•´ í•„ìš”
   - **ì˜ˆì‹œ**: `sales_entry.py` (454ì¤„, 459ì¤„), `settlement_actual.py` (339ì¤„, 351ì¤„)

3. **ìºì‹œ í´ë¦¬ì–´ í›„ ê°±ì‹ ** (í•„ìˆ˜)
   - ìºì‹œ ë¬´íš¨í™” í›„ rerun
   - **ì´ìœ **: ìƒˆë¡œìš´ ë°ì´í„°ë¥¼ ë¡œë“œí•˜ê¸° ìœ„í•´ í•„ìš”
   - **ì˜ˆì‹œ**: `home_page.py` (218ì¤„), `app.py` (1708ì¤„), `bootstrap.py` (799ì¤„)

4. **í…Œë§ˆ ë³€ê²½** (í•„ìˆ˜)
   - `st.session_state.theme = "light/dark"` í›„ rerun
   - **ì´ìœ **: ì „ì²´ ì•± í…Œë§ˆ ë³€ê²½ì€ ì¬ë Œë”ë§ í•„ìš”
   - **ì˜ˆì‹œ**: `app.py` (1624ì¤„, 1631ì¤„)

5. **ë¡œê·¸ì¸/ë¡œê·¸ì•„ì›ƒ** (í•„ìˆ˜)
   - ë¡œê·¸ì¸ ì„±ê³µ í›„ rerun
   - **ì´ìœ **: ì¸ì¦ ìƒíƒœ ë³€ê²½ì€ ì „ì²´ ì•± ì¬ë Œë”ë§ í•„ìš”
   - **ì˜ˆì‹œ**: `auth.py` (1224ì¤„), `app.py` (1639ì¤„)

6. **ì˜¨ë³´ë”©/ë§¤ì¥ ì„¤ì •** (í•„ìˆ˜)
   - ì˜¨ë³´ë”© ì™„ë£Œ í›„ rerun
   - **ì´ìœ **: ì•± ìƒíƒœ ë³€ê²½ì€ ì¬ë Œë”ë§ í•„ìš”
   - **ì˜ˆì‹œ**: `onboarding_mode_select.py` (54ì¤„), `store_setup.py` (74ì¤„)

7. **ì—°/ì›” ë³€ê²½** (í•„ìˆ˜)
   - `selected_year != year or selected_month != month` í›„ rerun
   - **ì´ìœ **: ë‹¤ë¥¸ ì›” ë°ì´í„°ë¥¼ ë¡œë“œí•˜ê¸° ìœ„í•´ í•„ìš”
   - **ì˜ˆì‹œ**: `settlement_actual.py` (281ì¤„)

---

## 3ï¸âƒ£ ì œê±° í›„ ë³€ê²½ëœ íŒŒì¼ ë¦¬ìŠ¤íŠ¸

### âœ… ìˆ˜ì • ì™„ë£Œ íŒŒì¼ (8ê°œ)

1. âœ… **ui_pages/home/home_page.py**
   - 3ê°œ rerun ì œê±° (expander í”Œë˜ê·¸ ë³€ê²½)

2. âœ… **app.py**
   - 4ê°œ rerun ì œê±° (í”Œë˜ê·¸ ë³€ê²½, í¸ì§‘ ëª¨ë“œ í† ê¸€)

3. âœ… **ui_pages/strategy/strategy_board.py**
   - 1ê°œ rerun ì œê±° (ì „ëµ ì¹´ë“œ ì™„ë£Œ ì €ì¥)

4. âœ… **ui_pages/settlement_actual.py**
   - 2ê°œ rerun ì œê±° (íˆìŠ¤í† ë¦¬ limit í”Œë˜ê·¸)

5. âœ… **ui_pages/sales_entry.py**
   - 1ê°œ rerun ì œê±° (ë©”ì‹œì§€ í”Œë˜ê·¸ ì‚­ì œ)

6. âœ… **ui_pages/design_lab/design_center.py**
   - 1ê°œ rerun ì œê±° (ì£¼ê°„ ì ê²€ ì™„ë£Œ ì²˜ë¦¬)

7. âœ… **src/auth.py**
   - 2ê°œ rerun ì œê±° (ë¡œê·¸ì¸/íšŒì›ê°€ì… í”Œë˜ê·¸)

8. âœ… **ui_pages/menu_profit_design_lab.py**
   - 4ê°œ rerun ì œê±° (ë©”ë‰´ íƒœê·¸ ë³€ê²½)

---

## 4ï¸âƒ£ ë¬´í•œ rerun ì°¨ë‹¨ì„ ìœ„í•´ ì¶”ê°€í•œ ê°€ë“œ

### í™•ì¸ëœ ì•ˆì „ íŒ¨í„´

1. **í˜ì´ì§€ ì´ë™ rerun**: í•­ìƒ `st.session_state["current_page"]` ë³€ê²½ í›„ ë‹¨ì¼ rerun
   - ë¬´í•œ ë£¨í”„ ìœ„í—˜ ì—†ìŒ (í˜ì´ì§€ê°€ ë°”ë€Œë©´ ë‹¤ë¥¸ ì½”ë“œ ê²½ë¡œ ì‹¤í–‰)

2. **ìºì‹œ í´ë¦¬ì–´ rerun**: ìºì‹œ ë¬´íš¨í™” í›„ ë‹¨ì¼ rerun
   - ë¬´í•œ ë£¨í”„ ìœ„í—˜ ì—†ìŒ (ìºì‹œ í´ë¦¬ì–´ëŠ” ì‚¬ìš©ì ì•¡ì…˜ì— ì˜í•´ì„œë§Œ ë°œìƒ)

3. **ë°ì´í„° ì €ì¥ rerun**: ì €ì¥ ì„±ê³µ í›„ ë‹¨ì¼ rerun
   - ë¬´í•œ ë£¨í”„ ìœ„í—˜ ì—†ìŒ (ì €ì¥ì€ ì‚¬ìš©ì ì•¡ì…˜ì— ì˜í•´ì„œë§Œ ë°œìƒ)

### ì ì¬ì  ìœ„í—˜ íŒ¨í„´ (ì¶”ê°€ í™•ì¸ í•„ìš”)

1. **ì—°/ì›” ë³€ê²½ ìë™ rerun** (`settlement_actual.py` 281ì¤„)
   - **ìœ„í—˜ë„**: ğŸŸ¡ ì¤‘
   - **ì´ìœ **: `number_input` ê°’ì´ ë³€ê²½ë˜ë©´ ìë™ìœ¼ë¡œ rerunì´ ë°œìƒí•˜ëŠ”ë°, ì½”ë“œì—ì„œë„ rerunì„ í˜¸ì¶œí•˜ë©´ ì¤‘ë³µ ê°€ëŠ¥
   - **í˜„ì¬ ìƒíƒœ**: ìœ ì§€ (í•„ìš”í•œ rerunì´ì§€ë§Œ, Streamlitì˜ ìë™ rerunê³¼ ì¤‘ë³µë  ìˆ˜ ìˆìŒ)
   - **ê¶Œì¥ ì¡°ì¹˜**: Streamlitì˜ ìë™ rerunì„ í™œìš©í•˜ë„ë¡ ê°œì„  ê°€ëŠ¥ (Phase 0 ë²”ìœ„ ë°–)

2. **ì¡°ê±´ë¶€ rerun ì²´ì¸**
   - **ìœ„í—˜ë„**: ğŸŸ¢ ë‚®ìŒ
   - **ì´ìœ **: ëŒ€ë¶€ë¶„ì˜ rerunì€ ì‚¬ìš©ì ì•¡ì…˜(ë²„íŠ¼ í´ë¦­) í›„ì—ë§Œ ë°œìƒí•˜ë¯€ë¡œ ì•ˆì „

---

## 5ï¸âƒ£ ì²´ê° ê°œì„  ì˜ˆìƒ í¬ì¸íŠ¸ 3ê°œ

### 1. í™ˆ í˜ì´ì§€ expander ì—´ê¸°/ë‹«ê¸° ë°˜ì‘ì„± í–¥ìƒ
**Before**: 
- "ìì„¸íˆ ë³´ê¸° (TOP3)" ë²„íŠ¼ í´ë¦­ â†’ rerun â†’ 1-2ì´ˆ ëŒ€ê¸° â†’ expander í‘œì‹œ

**After**:
- "ìì„¸íˆ ë³´ê¸° (TOP3)" ë²„íŠ¼ í´ë¦­ â†’ ì¦‰ì‹œ expander í‘œì‹œ (rerun ì—†ìŒ)

**ì²´ê° ê°œì„ **: âš¡ **ì¦‰ê°ì ì¸ ë°˜ì‘** (1-2ì´ˆ â†’ 0.1ì´ˆ)

### 2. í¸ì§‘ ëª¨ë“œ í† ê¸€ ë°˜ì‘ì„± í–¥ìƒ
**Before**:
- í¸ì§‘ ë²„íŠ¼ í´ë¦­ â†’ rerun â†’ 1-2ì´ˆ ëŒ€ê¸° â†’ í¸ì§‘ ëª¨ë“œ í‘œì‹œ

**After**:
- í¸ì§‘ ë²„íŠ¼ í´ë¦­ â†’ ì¦‰ì‹œ í¸ì§‘ ëª¨ë“œ í‘œì‹œ (rerun ì—†ìŒ)

**ì²´ê° ê°œì„ **: âš¡ **ì¦‰ê°ì ì¸ ë°˜ì‘** (1-2ì´ˆ â†’ 0.1ì´ˆ)

### 3. ë©”ë‰´ íƒœê·¸ ë³€ê²½ ë°˜ì‘ì„± í–¥ìƒ
**Before**:
- íƒœê·¸ ë²„íŠ¼ í´ë¦­ â†’ rerun â†’ 1-2ì´ˆ ëŒ€ê¸° â†’ íƒœê·¸ í‘œì‹œ ì—…ë°ì´íŠ¸

**After**:
- íƒœê·¸ ë²„íŠ¼ í´ë¦­ â†’ ì¦‰ì‹œ íƒœê·¸ í‘œì‹œ ì—…ë°ì´íŠ¸ (rerun ì—†ìŒ)

**ì²´ê° ê°œì„ **: âš¡ **ì¦‰ê°ì ì¸ ë°˜ì‘** (1-2ì´ˆ â†’ 0.1ì´ˆ)

---

## ğŸ“Š ìˆ˜ì • í†µê³„

### ì œê±° ì™„ë£Œ
- **ì´ íŒŒì¼ ìˆ˜**: 8ê°œ
- **ì´ ì œê±° ê±´ìˆ˜**: 12ê°œ
- **ì œê±° íŒ¨í„´**:
  - Expander í”Œë˜ê·¸: 3ê°œ
  - í¸ì§‘ ëª¨ë“œ í† ê¸€: 2ê°œ
  - ë‹¨ìˆœ ìƒíƒœ ë³€ê²½: 4ê°œ
  - ì¡°ê±´ë¶€ ë Œë”ë§ í”Œë˜ê·¸: 3ê°œ

### ìœ ì§€ëœ rerun
- **í˜ì´ì§€ ì´ë™**: ~150ê°œ (í•„ìˆ˜)
- **ë°ì´í„° ì €ì¥ í›„**: ~50ê°œ (í•„ìˆ˜)
- **ìºì‹œ í´ë¦¬ì–´ í›„**: ~20ê°œ (í•„ìˆ˜)
- **ê¸°íƒ€ í•„ìˆ˜**: ~34ê°œ (í…Œë§ˆ, ë¡œê·¸ì¸, ì˜¨ë³´ë”© ë“±)

---

## ğŸ¯ ë‹¤ìŒ ë‹¨ê³„

### Phase 0 STEP 4 ì˜ˆìƒ ì‘ì—…
1. **ì—°/ì›” ë³€ê²½ ìë™ rerun ìµœì í™”**
   - Streamlitì˜ ìë™ rerun í™œìš© ê²€í† 
   - ì¤‘ë³µ rerun ì œê±°

2. **ì €ì¥ í›„ rerun ìµœì í™”**
   - ì¼ë¶€ ì €ì¥ í•¨ìˆ˜ì—ì„œ ë¶ˆí•„ìš”í•œ rerun í™•ì¸
   - ë©”ì‹œì§€ í‘œì‹œë§Œìœ¼ë¡œ ì¶©ë¶„í•œ ê²½ìš° ê²€í† 

3. **ì„±ëŠ¥ ëª¨ë‹ˆí„°ë§**
   - rerun ë¹ˆë„ ì¸¡ì •
   - ì‚¬ìš©ì ì•¡ì…˜ë³„ rerun íšŸìˆ˜ ë¶„ì„

---

**ì‘ì—… ì™„ë£Œì¼**: 2026-01-24  
**ë‹¤ìŒ ì‘ì—…**: Phase 0 STEP 4 (ì¶”ê°€ rerun ìµœì í™”, í•„ìš” ì‹œ)
